<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Physics Knowledge Matrix</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <style>
    /* Add custom font for better readability */
    @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap');
    body {
      font-family: 'Inter', sans-serif;
      background-color: #f0f4f8; /* A cooler background color */
    }
    /* Styles for the card flip animation */
    .flip-card-container {
      perspective: 1000px;
    }
    .flip-card {
      transition: transform 0.6s;
      transform-style: preserve-3d;
      position: relative;
    }
    .is-flipped {
      transform: rotateY(180deg);
    }
    .flip-card-front, .flip-card-back {
      -webkit-backface-visibility: hidden; /* Safari */
      backface-visibility: hidden;
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
    }
    .flip-card-back {
      transform: rotateY(180deg);
    }
  </style>
</head>
<body class="p-4 md:p-8">
  <div id="root"></div>

  <script type="text/babel">
    const { useState } = React;

    // --- Mock Lucide Icons ---
    const createIcon = (svgContent) => ({ size = 24, className = '' }) => (
      <svg
        xmlns="http://www.w3.org/2000/svg"
        width={size}
        height={size}
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        strokeWidth="2"
        strokeLinecap="round"
        strokeLinejoin="round"
        className={className}
      >
        {svgContent}
      </svg>
    );

    const Book = createIcon(<path d="M4 19.5A2.5 2.5 0 0 1 6.5 17H20v2H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2H20v15H6.5A2.5 2.5 0 0 1 4 19.5z" />);
    const Zap = createIcon(<polygon points="13 2 3 14 12 14 11 22 21 10 12 10 13 2" />);
    const Target = createIcon(<><circle cx="12" cy="12" r="10" /><circle cx="12" cy="12" r="6" /><circle cx="12" cy="12" r="2" /></>);
    const AlertCircle = createIcon(<><circle cx="12" cy="12" r="10" /><line x1="12" y1="8" x2="12" y2="12" /><line x1="12" y1="16" x2="12.01" y2="16" /></>);
    const List = createIcon(<><line x1="8" x2="21" y1="6" y2="6"/><line x1="8" x2="21" y1="12" y2="12"/><line x1="8" x2="21" y1="18" y2="18"/><line x1="3" x2="3.01" y1="6" y2="6"/><line x1="3" x2="3.01" y1="12" y2="12"/><line x1="3" x2="3.01" y1="18" y2="18"/></>);
    
    // --- React Component ---
    const PhysicsKnowledgeMatrix = () => {
      const [activeView, setActiveView] = useState('matrix');
      const [hoveredCell, setHoveredCell] = useState(null);
      const [selectedArchetype, setSelectedArchetype] = useState(null);
      const [flippedCards, setFlippedCards] = useState({});
      const atomicNotesURL = 'physics-atomic-note.html'; // URL for the atomic notes page

      const handleFlip = (topicId) => {
        setFlippedCards(prev => ({...prev, [topicId]: !prev[topicId]}));
      }

      // --- Data Structures based on the T1-T9 Final AKM Directory ---

      const topics = [
        { id: 1, name: 'Measurement', color: 'bg-blue-100 border-blue-300', textColor: 'text-blue-700' },
        { id: 2, name: 'Kinematics', color: 'bg-green-100 border-green-300', textColor: 'text-green-700' },
        { id: 3, name: 'Forces/Dynamics', color: 'bg-purple-100 border-purple-300', textColor: 'text-purple-700' },
        { id: 4, name: 'Moments', color: 'bg-orange-100 border-orange-300', textColor: 'text-orange-700' },
        { id: 5, name: 'Energy/Work/Power', color: 'bg-red-100 border-red-300', textColor: 'text-red-700' },
        { id: 6, name: 'Thermal Physics', color: 'bg-pink-100 border-pink-300', textColor: 'text-pink-700' },
        { id: 7, name: 'Waves & Light', color: 'bg-indigo-100 border-indigo-300', textColor: 'text-indigo-700' },
        { id: 8, name: 'Electricity & Mag.', color: 'bg-yellow-100 border-yellow-300', textColor: 'text-yellow-700' },
        { id: 9, name: 'Radioactivity', color: 'bg-gray-200 border-gray-400', textColor: 'text-gray-800' }
      ];

      const archetypes = [
        { id: 'C1', name: 'Kinematics Graph Saga', icon: 'ðŸ“Š', type: 'Core', story: 'Reading the story of motion from graphs', variations: ['Constant velocity vs acceleration', 'Calculating distance from complex shapes', 'Drawing graphs from description'], color: 'bg-cyan-50', borderColor: 'border-cyan-300' },
        { id: 'C2', name: 'The Balancing Act', icon: 'âš–ï¸', type: 'Core', story: 'Making things not rotate', variations: ['Levers: see-saws, cranes', 'Stability on surfaces', 'Toppling point analysis'], color: 'bg-yellow-50', borderColor: 'border-yellow-300' },
        { id: 'C3', name: 'Energy Conversion Trail', icon: 'âš¡', type: 'Core', story: 'Tracking where the energy goes', variations: ['Slopes & ramps', 'Free fall & projectiles', 'Power calculation P=E/t'], color: 'bg-pink-50', borderColor: 'border-pink-300' },
        { id: 'C4', name: 'Particle Storytelling', icon: 'ðŸ”¬', type: 'Core', story: 'Explaining the visible with the invisible', variations: ['Heating/cooling curves', 'Heat transfer mechanisms', 'Evaporation cooling effect'], color: 'bg-rose-50', borderColor: 'border-rose-300' },
        { id: 'C5', name: 'Circuit Analysis Saga', icon: 'ðŸ”Œ', type: 'Core', story: 'Solving the puzzle of electron flow', variations: ['Series/parallel resistance', 'V=IR and P=VI calculations', 'Electrical safety analysis'], color: 'bg-sky-50', borderColor: 'border-sky-300' },
        { id: 'S1', name: 'Stability (CG & Base)', icon: 'ðŸ—ï¸', type: 'Satellite', story: 'Why things don\'t fall over', variations: ['Comparing stability', 'Loading effects on trucks', 'CG position for equilibrium'], color: 'bg-amber-50', borderColor: 'border-amber-300' },
        { id: 'S2', name: 'Vector Drawing & Dynamics', icon: 'ðŸŽ¯', type: 'Satellite', story: 'Finding net result of forces', variations: ['Graphical methods', 'Finding acceleration from Fnet=ma', 'Constant velocity scenarios'], color: 'bg-lime-50', borderColor: 'border-lime-300' },
        { id: 'S3', name: 'Density & Pressure Calc', icon: 'ðŸ“', type: 'Satellite', story: 'Calculating compactness and sharpness', variations: ['Pressure under blocks', 'Irregular object density', 'Wide tracks reducing pressure'], color: 'bg-teal-50', borderColor: 'border-teal-300' },
        { id: 'S4', name: 'Light Ray Tracing', icon: 'ðŸ’¡', type: 'Satellite', story: 'Following the path of light', variations: ['Mirror reflections', 'Refraction & critical angle', 'Lens ray diagrams'], color: 'bg-violet-50', borderColor: 'border-violet-300' }
      ];

      const akmDirectory = {
        'P1.1': 'Physical Quantities', 'P1.2': 'Using Vernier Calipers & Micrometers', 'P1.3': 'Errors & Precision',
        'P2.1': 'Describing Motion', 'P2.2': 'Graphs of Motion', 'P2.3': 'Types of Forces & Their Effects', 'P2.4': 'Dynamics (Newton\'s Laws)', 'P2.5': 'Pressure (P = F/A)', 'P2.6': 'Turning Effects of Forces (Moments)', 'P2.7': 'Centre of Gravity & Stability', 'P2.8': 'Work, Energy & The Principle of Conservation', 'P2.9': 'Power (P = E/t)',
        'P3.1': 'Kinetic Particle Model of Matter', 'P3.2': 'Thermal Processes', 'P3.3': 'Heat Transfer',
        'P4.1': 'General Wave Properties', 'P4.2': 'Sound', 'P4.3': 'EM Spectrum', 'P4.4': 'Reflection of Light', 'P4.5': 'Refraction of Light', 'P4.6': 'Thin Converging Lenses',
        'P5.1': 'Static Electricity', 'P5.2': 'Current, Charge & Potential Difference', 'P5.3': 'Resistance & Ohm\'s Law', 'P5.4': 'D.C. Circuits', 'P5.5': 'Practical Electricity', 'P5.6': 'Magnetism & Electromagnetism',
        'P6.1': 'The Atom & Radioactive Decay', 'P6.2': 'Half-Life'
      };

      const matrix = {
        '1-C1': { active: true, tools: ['Reading axes', 'Unit analysis'], akms: ['P1.1', 'P1.3'] }, '2-C1': { active: true, tools: ['Gradient = velocity/acceleration', 'Area = distance'], akms: ['P2.2'] }, '3-C1': { active: true, tools: ['F=ma explains graph changes'], akms: ['P2.4'] },
        '1-C2': { active: true, tools: ['Measuring distances from pivot'], akms: ['P1.2'] }, '3-C2': { active: true, tools: ['W=mg for weight calculation'], akms: ['P2.3'] }, '4-C2': { active: true, tools: ['Moment = Fd', 'Equilibrium principle'], akms: ['P2.6'] },
        '2-C3': { active: true, tools: ['vÂ² = uÂ² + 2as for velocity'], akms: ['P2.1'] }, '3-C3': { active: true, tools: ['Friction force Ff', 'Weight on slope'], akms: ['P2.3', 'P2.4'] }, '5-C3': { active: true, tools: ['GPE=mgh', 'KE=Â½mvÂ²', 'Work=Fd', 'Power=E/t'], akms: ['P2.8', 'P2.9'] }, '9-C3': { active: true, tools: ['Mass-energy equivalence'], akms: ['P6.1'] },
        '5-C4': { active: true, tools: ['Internal energy concepts'], akms: ['P2.8', 'P3.1'] }, '6-C4': { active: true, tools: ['Kinetic particle model', 'Latent heat'], akms: ['P3.1', 'P3.2'] }, '9-C4': { active: true, tools: ['Alpha, Beta, Gamma decay', 'Half-life calculations'], akms: ['P6.1', 'P6.2'] },
        '1-C5': { active: true, tools: ['Reading circuit diagrams'], akms: ['P1.1'] }, '8-C5': { active: true, tools: ['V=IR', 'P=VI', 'Series/parallel rules', 'Safety'], akms: ['P5.2', 'P5.3', 'P5.4', 'P5.5'] },
        '3-S1': { active: true, tools: ['Weight = mg'], akms: ['P2.3'] }, '4-S1': { active: true, tools: ['Centre of gravity location', 'Stability'], akms: ['P2.7'] },
        '1-S2': { active: true, tools: ['Scalar vs vector', 'Scale drawing'], akms: ['P1.1'] }, '3-S2': { active: true, tools: ['Fnet = ma', 'Vector addition'], akms: ['P2.4'] },
        '1-S3': { active: true, tools: ['Ï=m/V definition', 'P=F/A definition'], akms: ['P1.1', 'P2.3'] }, '3-S3': { active: true, tools: ['Pressure calculation with Weight'], akms: ['P2.5'] },
        '1-S4': { active: true, tools: ['Angle measurement', 'Protractor use'], akms: ['P1.1'] }, '7-S4': { active: true, tools: ['Law of reflection', 'Snell\'s Law', 'Lens rules'], akms: ['P4.4', 'P4.5', 'P4.6'] }
      };
      
      const topicToAkmsMap = {
          1: ['P1.1', 'P1.2', 'P1.3'],
          2: ['P2.1', 'P2.2'],
          3: ['P2.3', 'P2.4', 'P2.5'],
          4: ['P2.6', 'P2.7'],
          5: ['P2.8', 'P2.9'],
          6: ['P3.1', 'P3.2', 'P3.3'],
          7: ['P4.1', 'P4.2', 'P4.3', 'P4.4', 'P4.5', 'P4.6'],
          8: ['P5.1', 'P5.2', 'P5.3', 'P5.4', 'P5.5', 'P5.6'],
          9: ['P6.1', 'P6.2']
      };

      const groupedAkms = topics.map(topic => ({
        ...topic,
        akms: (topicToAkmsMap[topic.id] || []).map(id => ({ id, title: akmDirectory[id] }))
      }));

      return (
        <div className="w-full max-w-7xl mx-auto p-4 sm:p-6 bg-gradient-to-br from-slate-50 to-slate-100 rounded-xl shadow-lg">
          {/* Header */}
          <div className="mb-6">
            <h1 className="text-2xl sm:text-3xl font-bold text-slate-800 mb-2">Physics Knowledge Matrix</h1>
            <p className="text-slate-600">One-Page Strategy: Topics (Knowledge Warehouse) Ã— Archetypes (Battle SOPs)</p>
          </div>
          {/* View Selector */}
          <div className="mb-8">
            <div className="flex gap-3 flex-wrap">
              <button onClick={() => setActiveView('matrix')} className={`flex items-center gap-2 px-4 py-2 rounded-lg transition-all ${activeView === 'matrix' ? 'bg-emerald-600 text-white shadow-md' : 'bg-white text-slate-600 hover:bg-slate-200'}`}>
                <Target size={18} /><span className="font-medium">Matrix View</span>
              </button>
              <button onClick={() => setActiveView('warehouse')} className={`flex items-center gap-2 px-4 py-2 rounded-lg transition-all ${activeView === 'warehouse' ? 'bg-blue-600 text-white shadow-md' : 'bg-white text-slate-600 hover:bg-slate-200'}`}>
                <Book size={18} /><span className="font-medium">Warehouse (Topics)</span>
              </button>
              <button onClick={() => setActiveView('battlefield')} className={`flex items-center gap-2 px-4 py-2 rounded-lg transition-all ${activeView === 'battlefield' ? 'bg-purple-600 text-white shadow-md' : 'bg-white text-slate-600 hover:bg-slate-200'}`}>
                <Zap size={18} /><span className="font-medium">Battlefield (Archetypes)</span>
              </button>
              <button onClick={() => setActiveView('directory')} className={`flex items-center gap-2 px-4 py-2 rounded-lg transition-all ${activeView === 'directory' ? 'bg-gray-600 text-white shadow-md' : 'bg-white text-slate-600 hover:bg-slate-200'}`}>
                <List size={18} /><span className="font-medium">AKM Directory</span>
              </button>
            </div>
          </div>
          
          {/* Views */}
          <div className="transition-opacity duration-300 ease-in-out">
            {activeView === 'matrix' && (
              <div className="bg-white rounded-lg p-4 sm:p-6 shadow-inner animate-fade-in">
                {/* ... Matrix View Content ... */}
                <div className="flex items-start gap-4 mb-6">
                  <Target className="text-emerald-600 mt-1 flex-shrink-0" size={24} />
                  <div>
                    <h3 className="text-xl font-bold text-slate-800">The Integration Map</h3>
                    <p className="text-slate-600 text-sm mt-1">Horizontal = Static Knowledge / Vertical = Dynamic Problems / Intersection = Specific Tools</p>
                  </div>
                </div>
                <div className="overflow-x-auto">
                  <table className="w-full border-collapse min-w-[1200px]">
                    <thead>
                      <tr>
                        <th className="border-2 border-slate-300 bg-slate-200 p-3 text-sm font-bold text-slate-700 sticky left-0 z-10">Topics â†“ (AKM #)<br/>Archetypes â†’</th>
                        {archetypes.map(arch => (
                          <th key={arch.id} className={`border-2 ${arch.borderColor} ${arch.color} p-3 text-center min-w-[160px]`}>
                            <div className="text-2xl mb-1">{arch.icon}</div>
                            <div className="text-xs font-bold text-slate-800 mb-1">{arch.id}</div>
                            <div className="text-xs font-semibold text-slate-700">{arch.name}</div>
                            <div className="text-xs text-slate-500 mt-1 italic">({arch.type})</div>
                          </th>
                        ))}
                      </tr>
                    </thead>
                    <tbody>
                      {topics.map(topic => {
                        const topicAkms = groupedAkms.find(gAkm => gAkm.id === topic.id)?.akms || [];
                        const akmString = topicAkms.map(akm => `#${akm.id}`).join(', ');
                        return (
                          <tr key={topic.id}>
                            <td className={`border-2 border-slate-300 ${topic.color} p-3 font-bold text-sm ${topic.textColor} sticky left-0 z-10 bg-opacity-80 backdrop-blur-sm`}>
                              <div>T{topic.id}: {topic.name}</div>
                              {akmString && <div className="text-xs font-normal mt-1">({akmString})</div>}
                            </td>
                            {archetypes.map(arch => {
                              const cellKey = `${topic.id}-${arch.id}`;
                              const cellData = matrix[cellKey];
                              return (
                                <td key={cellKey} className={`border-2 border-slate-300 p-2 text-center transition-all duration-200 ${cellData?.active ? 'bg-gradient-to-br from-emerald-100 to-emerald-200 cursor-pointer hover:shadow-lg hover:scale-105 hover:relative hover:z-20' : 'bg-slate-50'}`} onMouseEnter={() => cellData?.active && setHoveredCell(cellKey)} onMouseLeave={() => setHoveredCell(null)}>
                                  {cellData?.active && (
                                    <div className="relative">
                                      <div className="text-2xl font-bold text-emerald-600">âœ“</div>
                                      {hoveredCell === cellKey && (
                                        <div className="absolute z-30 left-1/2 transform -translate-x-1/2 mt-2 bg-slate-800 text-white text-xs rounded-lg p-3 shadow-xl w-64 animate-fade-in-fast">
                                          <div className="font-bold mb-2 text-emerald-300">Tools Called:</div>
                                          <ul className="list-none p-0 m-0 mb-3">
                                            {cellData.tools.map((tool, idx) => (<li key={idx} className="mb-1 text-left pl-4 relative before:content-['â€¢'] before:absolute before:left-0 before:text-emerald-400">{tool}</li>))}
                                          </ul>
                                          {cellData.akms && cellData.akms.length > 0 && (
                                            <div>
                                              <div className="font-bold mb-2 text-amber-300 border-t border-slate-600 pt-2">Linked Atomic Notes:</div>
                                              <ul className="list-none p-0 m-0">
                                                {cellData.akms.map((akmId) => (
                                                  <li key={akmId} className="mb-1 text-left">
                                                    <a href={`${atomicNotesURL}#AKM-${akmId}`} target="_blank" rel="noopener noreferrer" className="text-amber-400 hover:text-amber-200 hover:underline pl-4 relative before:content-['#'] before:absolute before:left-0">{akmId}: {akmDirectory[akmId] || 'Note'}</a>
                                                  </li>
                                                ))}
                                              </ul>
                                            </div>
                                          )}
                                        </div>
                                      )}
                                    </div>
                                  )}
                                </td>
                              );
                            })}
                          </tr>
                        );
                      })}
                    </tbody>
                  </table>
                </div>
                 <div className="mt-6 grid md:grid-cols-2 gap-4">
                  <div className="p-4 bg-blue-50 border-l-4 border-blue-400 rounded"><p className="text-sm text-slate-700"><strong className="text-blue-700">Read Horizontally (by row):</strong> One Topic's knowledge serves multiple Archetypes</p></div>
                  <div className="p-4 bg-purple-50 border-l-4 border-purple-400 rounded"><p className="text-sm text-slate-700"><strong className="text-purple-700">Read Vertically (by column):</strong> One Archetype calls tools from multiple Topics</p></div>
                </div>
              </div>
            )}
            
            {activeView === 'warehouse' && (
              <div className="bg-white rounded-lg p-4 sm:p-6 shadow-inner animate-fade-in">
                 <div className="flex items-start gap-4 mb-4">
                  <Book className="text-blue-600 mt-1 flex-shrink-0" size={24} />
                  <div>
                    <h3 className="text-xl font-bold text-slate-800">Knowledge Warehouse: Systematic Learning Architecture</h3>
                    <p className="text-slate-600 text-sm mt-1">Build complete knowledge base by chapter sequence. Click any card to see its Atomic Notes.</p>
                  </div>
                </div>
                <div className="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6 mt-6">
                  {groupedAkms.map((topic) => (
                    <div key={topic.id} className="flip-card-container cursor-pointer h-40" onClick={() => handleFlip(topic.id)}>
                        <div className={`flip-card w-full h-full rounded-lg shadow-md ${flippedCards[topic.id] ? 'is-flipped' : ''}`}>
                            {/* Front of the card */}
                            <div className={`flip-card-front flex flex-col justify-center items-center text-center p-4 rounded-lg border-2 ${topic.color}`}>
                                <div className={`text-4xl font-bold ${topic.textColor} mb-2`}>T{topic.id}</div>
                                <div className="text-md font-semibold text-slate-800 mb-2">{topic.name}</div>
                                <div className="text-xs text-slate-600">Used in {Object.keys(matrix).filter(k => k.startsWith(`${topic.id}-`)).length} Archetypes</div>
                            </div>
                            {/* Back of the card */}
                            <div className={`flip-card-back grid grid-rows-[auto_1fr] p-3 rounded-lg border-2 ${topic.color}`}>
                                <h4 className={`font-bold ${topic.textColor} mb-2 text-center border-b pb-1`}>AKMs for T{topic.id}</h4>
                                <ul className="text-xs text-left space-y-1 overflow-y-auto pr-2">
                                  {topic.akms.map(akm => (
                                      <li key={akm.id}>
                                          <a href={`${atomicNotesURL}#AKM-${akm.id}`} target="_blank" rel="noopener noreferrer" className="text-blue-700 hover:underline" onClick={(e) => e.stopPropagation()}>
                                              <span className="font-mono bg-slate-200 px-1 rounded">{akm.id}</span>: {akm.title}
                                          </a>
                                      </li>
                                  ))}
                                </ul>
                            </div>
                        </div>
                    </div>
                  ))}
                </div>
                <div className="mt-8 p-4 bg-blue-50 border-l-4 border-blue-400 rounded">
                  <div className="flex items-start gap-3">
                    <AlertCircle className="text-blue-600 mt-0.5 flex-shrink-0" size={18} /><p className="text-sm text-slate-700"><strong>Purpose:</strong> Ensure zero knowledge gaps. Click a Topic card to reveal the specific Atomic Knowledge Modules (AKMs) it contains.</p>
                  </div>
                </div>
              </div>
            )}
            
            {activeView === 'battlefield' && (
              <div className="bg-white rounded-lg p-4 sm:p-6 shadow-inner animate-fade-in">
                 {/* ... Battlefield view content remains the same ... */}
                <div className="flex items-start gap-4 mb-4">
                  <Zap className="text-purple-600 mt-1 flex-shrink-0" size={24} />
                  <div>
                    <h3 className="text-xl font-bold text-slate-800">Battlefield: Problem-Oriented Battle Plans</h3>
                    <p className="text-slate-600 text-sm mt-1">Match question patterns to strategies instantly (Ensures Output Efficiency)</p>
                  </div>
                </div>
                <div className="mb-4 flex gap-2 flex-wrap">
                  <button onClick={() => setSelectedArchetype(null)} className={`px-3 py-1 rounded text-sm transition-all ${selectedArchetype === null ? 'bg-slate-700 text-white' : 'bg-slate-200 text-slate-600 hover:bg-slate-300'}`}>All ({archetypes.length})</button>
                  <button onClick={() => setSelectedArchetype('Core')} className={`px-3 py-1 rounded text-sm transition-all ${selectedArchetype === 'Core' ? 'bg-purple-600 text-white' : 'bg-purple-100 text-purple-700 hover:bg-purple-200'}`}>Core ({archetypes.filter(a => a.type === 'Core').length})</button>
                  <button onClick={() => setSelectedArchetype('Satellite')} className={`px-3 py-1 rounded text-sm transition-all ${selectedArchetype === 'Satellite' ? 'bg-emerald-600 text-white' : 'bg-emerald-100 text-emerald-700 hover:bg-emerald-200'}`}>Satellite ({archetypes.filter(a => a.type === 'Satellite').length})</button>
                </div>
                <div className="space-y-3">
                  {archetypes.filter(arch => !selectedArchetype || arch.type === selectedArchetype).map((arch) => (
                    <div key={arch.id} className={`${arch.color} border-2 ${arch.borderColor} rounded-lg p-4 sm:p-5 transition-all hover:shadow-md hover:border-slate-400`}>
                      <div className="flex flex-col sm:flex-row items-start gap-4">
                        <span className="text-4xl flex-shrink-0 mt-1">{arch.icon}</span>
                        <div className="flex-1">
                          <div className="flex flex-wrap items-center gap-3 mb-2"><h4 className="font-bold text-slate-800 text-lg">{arch.id}: {arch.name}</h4><span className={`px-2 py-1 rounded text-xs font-semibold ${arch.type === 'Core' ? 'bg-purple-200 text-purple-800' : 'bg-emerald-200 text-emerald-800'}`}>{arch.type}</span></div>
                          <p className="text-sm text-slate-700 italic mb-3">"{arch.story}"</p>
                          <div className="mb-3">
                            <div className="text-xs font-semibold text-slate-600 mb-1">Common Variations:</div>
                            <div className="flex flex-wrap gap-2">{arch.variations.map((v, idx) => (<span key={idx} className="text-xs bg-white px-2 py-1 rounded border border-slate-200">{v}</span>))}</div>
                          </div>
                          <div className="flex items-center gap-2 text-xs text-slate-600 flex-wrap">
                            <span className="font-semibold">Tools from:</span>
                            {Object.keys(matrix).filter(k => k.endsWith(`-${arch.id}`)).map(k => {
                                const topicId = parseInt(k.split('-')[0]); const topic = topics.find(t => t.id === topicId); if (!topic) return null; const borderColor = topic.borderColor ? topic.borderColor.replace('300', '400') : 'border-slate-400';
                                return (<span key={k} className={`${topic.color} px-2 py-1 rounded border ${borderColor} font-medium`}>T{topicId}</span>);
                            })}
                          </div>
                        </div>
                      </div>
                    </div>
                  ))}
                </div>
                <div className="mt-6 p-4 bg-purple-50 border-l-4 border-purple-400 rounded">
                  <div className="flex items-start gap-3">
                    <AlertCircle className="text-purple-600 mt-0.5 flex-shrink-0" size={18} /><p className="text-sm text-slate-700"><strong>Purpose:</strong> Rapid question-type recognition in combat. First question when seeing a problem: "Which game is this?" not "Which chapter?"</p>
                  </div>
                </div>
              </div>
            )}

            {activeView === 'directory' && (
              <div className="bg-white rounded-lg p-4 sm:p-6 shadow-inner animate-fade-in">
                 {/* ... Directory View Content ... */}
                <div className="flex items-start gap-4 mb-6">
                  <List className="text-gray-600 mt-1 flex-shrink-0" size={24} />
                  <div>
                    <h3 className="text-xl font-bold text-slate-800">Atomic Knowledge Module (AKM) Directory</h3>
                    <p className="text-slate-600 text-sm mt-1">The definitive index mapping syllabus topics to their corresponding note modules.</p>
                  </div>
                </div>
                <div className="overflow-x-auto">
                  <table className="w-full border-collapse">
                    <thead className="bg-slate-100">
                      <tr>
                        <th className="p-3 text-left text-sm font-semibold text-slate-600 border-b-2 border-slate-200">Syllabus Topic</th>
                        <th className="p-3 text-left text-sm font-semibold text-slate-600 border-b-2 border-slate-200">AKM #</th>
                        <th className="p-3 text-left text-sm font-semibold text-slate-600 border-b-2 border-slate-200">AKM Title (Atomic Note)</th>
                      </tr>
                    </thead>
                    <tbody>
                      {groupedAkms.map((topic) => (
                        <React.Fragment key={topic.id}>
                          {topic.akms.map((akm, akmIndex) => (
                            <tr key={akm.id} className="hover:bg-slate-50">
                              {akmIndex === 0 && (
                                <td rowSpan={topic.akms.length} className={`p-3 border-b border-slate-200 font-bold text-sm ${topic.textColor} align-top`}>
                                  T{topic.id}: {topic.name}
                                </td>
                              )}
                              <td className="p-3 border-b border-slate-200 font-mono text-sm text-slate-700">
                                <a href={`${atomicNotesURL}#AKM-${akm.id}`} target="_blank" rel="noopener noreferrer" className="text-blue-600 hover:underline">{akm.id}</a>
                              </td>
                              <td className="p-3 border-b border-slate-200 text-sm text-slate-800">{akm.title}</td>
                            </tr>
                          ))}
                        </React.Fragment>
                      ))}
                    </tbody>
                  </table>
                </div>
              </div>
            )}
          </div>
          
          {/* Bottom Summary */}
          <div className="mt-8 p-6 bg-gradient-to-r from-slate-800 to-slate-700 rounded-lg text-white">
            <h4 className="font-bold text-lg mb-3">ðŸŽ¯ Design Logic Summary</h4>
            <div className="grid sm:grid-cols-3 gap-4 text-sm">
              <div><div className="font-bold mb-1 text-blue-300">Warehouse Perspective</div><div className="text-slate-300">Ensures systematic & complete learning (Knowledge Input)</div></div>
              <div><div className="font-bold mb-1 text-purple-300">Battlefield Perspective</div><div className="text-slate-300">Ensures efficient & accurate problem-solving (Question Output)</div></div>
              <div><div className="font-bold mb-1 text-emerald-300">Matrix Perspective</div><div className="text-slate-300">Reveals mapping relationships (Integration & Transfer)</div></div>
            </div>
            <div className="mt-4 pt-4 border-t border-slate-600"><p className="text-xs text-slate-400 italic">Master Insight: Novices use "Warehouse only" (learn chapter â†’ do chapter). Experts switch to "Battlefield" (see question â†’ identify pattern). Champions integrate "Matrix" (one tool â†’ multiple contexts).</p></div>
          </div>
          <style>{`
            @keyframes fade-in { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
            .animate-fade-in { animation: fade-in 0.4s ease-out forwards; }
            @keyframes fade-in-fast { from { opacity: 0; } to { opacity: 1; } }
            .animate-fade-in-fast { animation: fade-in-fast 0.2s ease-out forwards; }
          `}</style>
        </div>
      );
    };

    const container = document.getElementById('root');
    const root = ReactDOM.createRoot(container);
    root.render(<PhysicsKnowledgeMatrix />);
  </script>
</body>
</html>

<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Physics Knowledge Matrix</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <style>
    /* Add custom font for better readability */
    @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap');
    body {
      font-family: 'Inter', sans-serif;
      background-color: #f0f4f8; /* A cooler background color */
    }
    /* Styles for the card flip animation */
    .flip-card-container {
      perspective: 1000px;
    }
    .flip-card {
      transition: transform 0.6s;
      transform-style: preserve-3d;
      position: relative;
    }
    .is-flipped {
      transform: rotateY(180deg);
    }
    .flip-card-front, .flip-card-back {
      -webkit-backface-visibility: hidden; /* Safari */
      backface-visibility: hidden;
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
    }
    .flip-card-back {
      transform: rotateY(180deg);
    }
  </style>
</head>
<body class="p-4 md:p-8">
  <div id="root"></div>

  <script type="text/babel">
    const { useState } = React;

    // --- Mock Lucide Icons ---
    const createIcon = (svgContent) => ({ size = 24, className = '' }) => (
      <svg
        xmlns="http://www.w3.org/2000/svg"
        width={size}
        height={size}
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        strokeWidth="2"
        strokeLinecap="round"
        strokeLinejoin="round"
        className={className}
      >
        {svgContent}
      </svg>
    );

    const Book = createIcon(<path d="M4 19.5A2.5 2.5 0 0 1 6.5 17H20v2H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2H20v15H6.5A2.5 2.5 0 0 1 4 19.5z" />);
    const Zap = createIcon(<polygon points="13 2 3 14 12 14 11 22 21 10 12 10 13 2" />);
    const Target = createIcon(<><circle cx="12" cy="12" r="10" /><circle cx="12" cy="12" r="6" /><circle cx="12" cy="12" r="2" /></>);
    const AlertCircle = createIcon(<><circle cx="12" cy="12" r="10" /><line x1="12" y1="8" x2="12" y2="12" /><line x1="12" y1="16" x2="12.01" y2="16" /></>);
    const List = createIcon(<><line x1="8" x2="21" y1="6" y2="6"/><line x1="8" x2="21" y1="12" y2="12"/><line x1="8" x2="21" y1="18" y2="18"/><line x1="3" x2="3.01" y1="6" y2="6"/><line x1="3" x2="3.01" y1="12" y2="12"/><line x1="3" x2="3.01" y1="18" y2="18"/></>);
    
    // --- React Component ---
    const PhysicsKnowledgeMatrix = () => {
      const [activeView, setActiveView] = useState('warehouse');
      const [hoveredCell, setHoveredCell] = useState(null);
      const [selectedArchetype, setSelectedArchetype] = useState(null);
      const [flippedCards, setFlippedCards] = useState({});
      const atomicNotesURL = 'physics-atomic-note.html'; // URL for the atomic notes page

      const handleFlip = (topicId) => {
        setFlippedCards(prev => ({...prev, [topicId]: !prev[topicId]}));
      }

      const topics = [
        { id: 1, name: 'Measurement', color: 'bg-blue-100 border-blue-300', textColor: 'text-blue-700' },
        { id: 2, name: 'Kinematics', color: 'bg-green-100 border-green-300', textColor: 'text-green-700' },
        { id: 3, name: 'Forces/Dynamics', color: 'bg-purple-100 border-purple-300', textColor: 'text-purple-700' },
        { id: 4, name: 'Moments', color: 'bg-orange-100 border-orange-300', textColor: 'text-orange-700' },
        { id: 5, name: 'Energy/Work/Power', color: 'bg-red-100 border-red-300', textColor: 'text-red-700' },
        { id: 6, name: 'Thermal Physics', color: 'bg-pink-100 border-pink-300', textColor: 'text-pink-700' },
        { id: 7, name: 'Waves & Light', color: 'bg-indigo-100 border-indigo-300', textColor: 'text-indigo-700' },
        { id: 8, name: 'Electricity & Mag.', color: 'bg-yellow-100 border-yellow-300', textColor: 'text-yellow-700' }
      ];

      const archetypes = [
        { id: 'C1', name: 'Kinematics Graph Saga', icon: 'ðŸ“Š', type: 'Core', story: 'Reading the story of motion from graphs', variations: ['Constant velocity vs acceleration', 'Calculating distance from complex shapes', 'Drawing graphs from description'], color: 'bg-cyan-50', borderColor: 'border-cyan-300' },
        { id: 'C2', name: 'The Balancing Act', icon: 'âš–ï¸', type: 'Core', story: 'Making things not rotate', variations: ['Levers: see-saws, cranes', 'Stability on surfaces', 'Toppling point analysis'], color: 'bg-yellow-50', borderColor: 'border-yellow-300' },
        { id: 'C3', name: 'Energy Conversion Trail', icon: 'âš¡', type: 'Core', story: 'Tracking where the energy goes', variations: ['Slopes & ramps', 'Free fall & projectiles', 'Power calculation P=E/t'], color: 'bg-pink-50', borderColor: 'border-pink-300' },
        { id: 'C4', name: 'Particle Storytelling', icon: 'ðŸ”¬', type: 'Core', story: 'Explaining the visible with the invisible', variations: ['Heating/cooling curves', 'Heat transfer mechanisms', 'Evaporation cooling effect'], color: 'bg-rose-50', borderColor: 'border-rose-300' },
        { id: 'C5', name: 'Circuit Analysis Saga', icon: 'ðŸ”Œ', type: 'Core', story: 'Solving the puzzle of electron flow', variations: ['Series/parallel resistance', 'V=IR and P=VI calculations', 'Electrical safety analysis'], color: 'bg-sky-50', borderColor: 'border-sky-300' },
        { id: 'S1', name: 'Stability (CG & Base)', icon: 'ðŸ—ï¸', type: 'Satellite', story: 'Why things don\'t fall over', variations: ['Comparing stability', 'Loading effects on trucks', 'CG position for equilibrium'], color: 'bg-amber-50', borderColor: 'border-amber-300' },
        { id: 'S2', name: 'Vector Drawing & Dynamics', icon: 'ðŸŽ¯', type: 'Satellite', story: 'Finding net result of forces', variations: ['Graphical methods', 'Finding acceleration from Fnet=ma', 'Constant velocity scenarios'], color: 'bg-lime-50', borderColor: 'border-lime-300' },
        { id: 'S3', name: 'Density & Pressure Calc', icon: 'ðŸ“', type: 'Satellite', story: 'Calculating compactness and sharpness', variations: ['Pressure under blocks', 'Irregular object density', 'Wide tracks reducing pressure'], color: 'bg-teal-50', borderColor: 'border-teal-300' },
        { id: 'S4', name: 'Light Ray Tracing', icon: 'ðŸ’¡', type: 'Satellite', story: 'Following the path of light', variations: ['Mirror reflections', 'Refraction & critical angle', 'Lens ray diagrams'], color: 'bg-violet-50', borderColor: 'border-violet-300' }
      ];

      const akmDirectory = {
        'P1.1': 'Physical Quantities', 'P1.2': 'Vernier Calipers & Micrometers', 'P1.3': 'Errors & Precision',
        'P2.1': 'Describing Motion', 'P2.2': 'Graphs of Motion',
        'P3.1': 'Forces & Their Effects', 'P3.2': 'Dynamics (Newton\'s Laws)', 'P3.3': 'Friction & Air Resistance', 'P3.4': 'Pressure (P=F/A)',
        'P4.1': 'Turning Effects of Forces', 'P4.2': 'Centre of Gravity & Stability',
        'P5.1': 'Energy, Work & Conservation', 'P5.2': 'KE & GPE', 'P5.3': 'Power (P=E/t)',
        'P6.1': 'Kinetic Particle Model', 'P6.2': 'Thermal Processes', 'P6.3': 'Heat Transfer',
        'P7.1': 'General Wave Properties', 'P7.2': 'Sound', 'P7.3': 'EM Spectrum', 'P7.4': 'Reflection of Light', 'P7.5': 'Refraction of Light', 'P7.6': 'Thin Converging Lenses',
        'P8.1': 'Static Electricity', 'P8.2': 'Current, Charge & P.D.', 'P8.3': 'Resistance & Ohm\'s Law', 'P8.4': 'D.C. Circuits', 'P8.5': 'Practical Electricity', 'P8.6': 'Magnetism'
      };

      const matrix = {
        '1-C1': { active: true, tools: ['Reading axes', 'Unit analysis'], akms: ['P1.1', 'P1.3'] }, '2-C1': { active: true, tools: ['Gradient = velocity/acceleration', 'Area = distance'], akms: ['P2.2'] }, '3-C1': { active: true, tools: ['F=ma explains graph changes', 'Resultant force analysis'], akms: ['P3.2'] },
        '1-C2': { active: true, tools: ['Measuring distances from pivot'], akms: ['P1.2'] }, '3-C2': { active: true, tools: ['W=mg for weight calculation'], akms: ['P3.1'] }, '4-C2': { active: true, tools: ['Moment = Fd', 'Equilibrium principle'], akms: ['P4.1'] },
        '2-C3': { active: true, tools: ['vÂ² = uÂ² + 2as for velocity'], akms: ['P2.1'] }, '3-C3': { active: true, tools: ['Friction force Ff', 'Weight component on slope'], akms: ['P3.3'] }, '5-C3': { active: true, tools: ['GPE=mgh', 'KE=Â½mvÂ²', 'Work=Fd', 'Power=E/t'], akms: ['P5.1', 'P5.2', 'P5.3'] },
        '5-C4': { active: true, tools: ['Internal energy concepts'], akms: ['P5.1', 'P6.1'] }, '6-C4': { active: true, tools: ['Kinetic particle model', 'Specific heat capacity', 'Latent heat'], akms: ['P6.1', 'P6.2'] },
        '1-C5': { active: true, tools: ['Reading circuit diagrams', 'Ammeter/voltmeter placement'], akms: ['P1.1'] }, '8-C5': { active: true, tools: ['V=IR', 'P=VI', 'Series/parallel rules', 'Electrical safety'], akms: ['P8.2', 'P8.3', 'P8.4', 'P8.5'] },
        '3-S1': { active: true, tools: ['Weight = mg'], akms: ['P3.1'] }, '4-S1': { active: true, tools: ['Centre of gravity location', 'Stability conditions'], akms: ['P4.2'] },
        '1-S2': { active: true, tools: ['Scalar vs vector', 'Scale drawing'], akms: ['P1.1'] }, '3-S2': { active: true, tools: ['Fnet = ma', 'Vector addition', 'Resolving forces'], akms: ['P3.2'] },
        '1-S3': { active: true, tools: ['Ï=m/V definition', 'P=F/A definition'], akms: ['P1.1', 'P3.1'] }, '3-S3': { active: true, tools: ['Force = Weight (W=mg) for pressure calculation'], akms: ['P3.4'] },
        '1-S4': { active: true, tools: ['Angle measurement', 'Protractor use'], akms: ['P1.1'] }, '7-S4': { active: true, tools: ['Law of reflection', 'n=sin i/sin r', 'Lens ray rules'], akms: ['P7.4', 'P7.5', 'P7.6'] }
      };

      const groupedAkms = topics.map(topic => ({
        ...topic,
        akms: Object.entries(akmDirectory)
          .filter(([key]) => key.startsWith(`P${topic.id}.`))
          .map(([id, title]) => ({ id, title }))
      }));

      return (
        <div className="w-full max-w-7xl mx-auto p-4 sm:p-6 bg-gradient-to-br from-slate-50 to-slate-100 rounded-xl shadow-lg">
          {/* Header */}
          <div className="mb-6">
            <h1 className="text-2xl sm:text-3xl font-bold text-slate-800 mb-2">Physics 5086: Knowledge Matrix</h1>
            <p className="text-slate-600">One-Page Strategy: Topics (Knowledge Warehouse) Ã— Archetypes (Battle SOPs)</p>
          </div>
          {/* View Selector */}
          <div className="mb-8">
            <div className="flex gap-3 flex-wrap">
              <button onClick={() => setActiveView('matrix')} className={`flex items-center gap-2 px-4 py-2 rounded-lg transition-all ${activeView === 'matrix' ? 'bg-emerald-600 text-white shadow-md' : 'bg-white text-slate-600 hover:bg-slate-200'}`}>
                <Target size={18} /><span className="font-medium">Matrix View</span>
              </button>
              <button onClick={() => setActiveView('warehouse')} className={`flex items-center gap-2 px-4 py-2 rounded-lg transition-all ${activeView === 'warehouse' ? 'bg-blue-600 text-white shadow-md' : 'bg-white text-slate-600 hover:bg-slate-200'}`}>
                <Book size={18} /><span className="font-medium">Warehouse (Topics)</span>
              </button>
              <button onClick={() => setActiveView('battlefield')} className={`flex items-center gap-2 px-4 py-2 rounded-lg transition-all ${activeView === 'battlefield' ? 'bg-purple-600 text-white shadow-md' : 'bg-white text-slate-600 hover:bg-slate-200'}`}>
                <Zap size={18} /><span className="font-medium">Battlefield (Archetypes)</span>
              </button>
              <button onClick={() => setActiveView('directory')} className={`flex items-center gap-2 px-4 py-2 rounded-lg transition-all ${activeView === 'directory' ? 'bg-gray-600 text-white shadow-md' : 'bg-white text-slate-600 hover:bg-slate-200'}`}>
                <List size={18} /><span className="font-medium">AKM Directory</span>
              </button>
            </div>
          </div>
          
          {/* Views */}
          <div className="transition-opacity duration-300 ease-in-out">
            {activeView === 'matrix' && (
              <div className="bg-white rounded-lg p-4 sm:p-6 shadow-inner animate-fade-in">
                {/* ... Matrix View Content ... */}
                <div className="flex items-start gap-4 mb-6">
                  <Target className="text-emerald-600 mt-1 flex-shrink-0" size={24} />
                  <div>
                    <h3 className="text-xl font-bold text-slate-800">The Integration Map</h3>
                    <p className="text-slate-600 text-sm mt-1">Horizontal = Static Knowledge / Vertical = Dynamic Problems / Intersection = Specific Tools</p>
                  </div>
                </div>
                <div className="overflow-x-auto">
                  <table className="w-full border-collapse min-w-[1200px]">
                    <thead>
                      <tr>
                        <th className="border-2 border-slate-300 bg-slate-200 p-3 text-sm font-bold text-slate-700 sticky left-0 z-10">Topics â†“<br/>Archetypes â†’</th>
                        {archetypes.map(arch => (
                          <th key={arch.id} className={`border-2 ${arch.borderColor} ${arch.color} p-3 text-center min-w-[160px]`}>
                            <div className="text-2xl mb-1">{arch.icon}</div>
                            <div className="text-xs font-bold text-slate-800 mb-1">{arch.id}</div>
                            <div className="text-xs font-semibold text-slate-700">{arch.name}</div>
                            <div className="text-xs text-slate-500 mt-1 italic">({arch.type})</div>
                          </th>
                        ))}
                      </tr>
                    </thead>
                    <tbody>
                      {topics.map(topic => (
                        <tr key={topic.id}>
                          <td className={`border-2 border-slate-300 ${topic.color} p-3 font-bold text-sm ${topic.textColor} sticky left-0 z-10 bg-opacity-80 backdrop-blur-sm`}>T{topic.id}: {topic.name}</td>
                          {archetypes.map(arch => {
                            const cellKey = `${topic.id}-${arch.id}`;
                            const cellData = matrix[cellKey];
                            return (
                              <td key={cellKey} className={`border-2 border-slate-300 p-2 text-center transition-all duration-200 ${cellData?.active ? 'bg-gradient-to-br from-emerald-100 to-emerald-200 cursor-pointer hover:shadow-lg hover:scale-105 hover:z-20' : 'bg-slate-50'}`} onMouseEnter={() => cellData?.active && setHoveredCell(cellKey)} onMouseLeave={() => setHoveredCell(null)}>
                                {cellData?.active && (
                                  <div className="relative">
                                    <div className="text-2xl font-bold text-emerald-600">âœ“</div>
                                    {hoveredCell === cellKey && (
                                      <div className="absolute z-30 left-1/2 transform -translate-x-1/2 mt-2 bg-slate-800 text-white text-xs rounded-lg p-3 shadow-xl w-64 animate-fade-in-fast">
                                        <div className="font-bold mb-2 text-emerald-300">Tools Called:</div>
                                        <ul className="list-none p-0 m-0 mb-3">
                                          {cellData.tools.map((tool, idx) => (<li key={idx} className="mb-1 text-left pl-4 relative before:content-['â€¢'] before:absolute before:left-0 before:text-emerald-400">{tool}</li>))}
                                        </ul>
                                        {cellData.akms && cellData.akms.length > 0 && (
                                          <div>
                                            <div className="font-bold mb-2 text-amber-300 border-t border-slate-600 pt-2">Linked Atomic Notes:</div>
                                            <ul className="list-none p-0 m-0">
                                              {cellData.akms.map((akmId) => (
                                                <li key={akmId} className="mb-1 text-left">
                                                  <a href={`${atomicNotesURL}#AKM-${akmId}`} target="_blank" rel="noopener noreferrer" className="text-amber-400 hover:text-amber-200 hover:underline pl-4 relative before:content-['#'] before:absolute before:left-0">{akmId}: {akmDirectory[akmId] || 'Note'}</a>
                                                </li>
                                              ))}
                                            </ul>
                                          </div>
                                        )}
                                      </div>
                                    )}
                                  </div>
                                )}
                              </td>
                            );
                          })}
                        </tr>
                      ))}
                    </tbody>
                  </table>
                </div>
                 <div className="mt-6 grid md:grid-cols-2 gap-4">
                  <div className="p-4 bg-blue-50 border-l-4 border-blue-400 rounded"><p className="text-sm text-slate-700"><strong className="text-blue-700">Read Horizontally (by row):</strong> One Topic's knowledge serves multiple Archetypes</p></div>
                  <div className="p-4 bg-purple-50 border-l-4 border-purple-400 rounded"><p className="text-sm text-slate-700"><strong className="text-purple-700">Read Vertically (by column):</strong> One Archetype calls tools from multiple Topics</p></div>
                </div>
              </div>
            )}
            
            {activeView === 'warehouse' && (
              <div className="bg-white rounded-lg p-4 sm:p-6 shadow-inner animate-fade-in">
                 <div className="flex items-start gap-4 mb-4">
                  <Book className="text-blue-600 mt-1 flex-shrink-0" size={24} />
                  <div>
                    <h3 className="text-xl font-bold text-slate-800">Knowledge Warehouse: Systematic Learning Architecture</h3>
                    <p className="text-slate-600 text-sm mt-1">Build complete knowledge base by chapter sequence. Click any card to see its Atomic Notes.</p>
                  </div>
                </div>
                <div className="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6 mt-6">
                  {groupedAkms.map((topic) => (
                    <div key={topic.id} className="flip-card-container cursor-pointer h-40" onClick={() => handleFlip(topic.id)}>
                        <div className={`flip-card w-full h-full rounded-lg shadow-md ${flippedCards[topic.id] ? 'is-flipped' : ''}`}>
                            {/* Front of the card */}
                            <div className={`flip-card-front flex flex-col justify-center items-center text-center p-4 rounded-lg border-2 ${topic.color}`}>
                                <div className={`text-4xl font-bold ${topic.textColor} mb-2`}>T{topic.id}</div>
                                <div className="text-md font-semibold text-slate-800 mb-2">{topic.name}</div>
                                <div className="text-xs text-slate-600">Used in {Object.keys(matrix).filter(k => k.startsWith(`${topic.id}-`)).length} Archetypes</div>
                            </div>
                            {/* Back of the card */}
                            <div className={`flip-card-back grid grid-rows-[auto_1fr] p-3 rounded-lg border-2 ${topic.color}`}>
                                <h4 className={`font-bold ${topic.textColor} mb-2 text-center border-b pb-1`}>AKMs for T{topic.id}</h4>
                                <ul className="text-xs text-left space-y-1 overflow-y-auto pr-2">
                                  {topic.akms.map(akm => (
                                      <li key={akm.id}>
                                          <a href={`${atomicNotesURL}#AKM-${akm.id}`} target="_blank" rel="noopener noreferrer" className="text-blue-700 hover:underline" onClick={(e) => e.stopPropagation()}>
                                              <span className="font-mono bg-slate-200 px-1 rounded">{akm.id}</span>: {akm.title}
                                          </a>
                                      </li>
                                  ))}
                                </ul>
                            </div>
                        </div>
                    </div>
                  ))}
                </div>
                <div className="mt-8 p-4 bg-blue-50 border-l-4 border-blue-400 rounded">
                  <div className="flex items-start gap-3">
                    <AlertCircle className="text-blue-600 mt-0.5 flex-shrink-0" size={18} /><p className="text-sm text-slate-700"><strong>Purpose:</strong> Ensure zero knowledge gaps. Click a Topic card to reveal the specific Atomic Knowledge Modules (AKMs) it contains.</p>
                  </div>
                </div>
              </div>
            )}
            
            {activeView === 'battlefield' && (
              <div className="bg-white rounded-lg p-4 sm:p-6 shadow-inner animate-fade-in">
                 {/* ... Battlefield view content remains the same ... */}
                <div className="flex items-start gap-4 mb-4">
                  <Zap className="text-purple-600 mt-1 flex-shrink-0" size={24} />
                  <div>
                    <h3 className="text-xl font-bold text-slate-800">Battlefield: Problem-Oriented Battle Plans</h3>
                    <p className="text-slate-600 text-sm mt-1">Match question patterns to strategies instantly (Ensures Output Efficiency)</p>
                  </div>
                </div>
                <div className="mb-4 flex gap-2 flex-wrap">
                  <button onClick={() => setSelectedArchetype(null)} className={`px-3 py-1 rounded text-sm transition-all ${selectedArchetype === null ? 'bg-slate-700 text-white' : 'bg-slate-200 text-slate-600 hover:bg-slate-300'}`}>All ({archetypes.length})</button>
                  <button onClick={() => setSelectedArchetype('Core')} className={`px-3 py-1 rounded text-sm transition-all ${selectedArchetype === 'Core' ? 'bg-purple-600 text-white' : 'bg-purple-100 text-purple-700 hover:bg-purple-200'}`}>Core ({archetypes.filter(a => a.type === 'Core').length})</button>
                  <button onClick={() => setSelectedArchetype('Satellite')} className={`px-3 py-1 rounded text-sm transition-all ${selectedArchetype === 'Satellite' ? 'bg-emerald-600 text-white' : 'bg-emerald-100 text-emerald-700 hover:bg-emerald-200'}`}>Satellite ({archetypes.filter(a => a.type === 'Satellite').length})</button>
                </div>
                <div className="space-y-3">
                  {archetypes.filter(arch => !selectedArchetype || arch.type === selectedArchetype).map((arch) => (
                    <div key={arch.id} className={`${arch.color} border-2 ${arch.borderColor} rounded-lg p-4 sm:p-5 transition-all hover:shadow-md hover:border-slate-400`}>
                      <div className="flex flex-col sm:flex-row items-start gap-4">
                        <span className="text-4xl flex-shrink-0 mt-1">{arch.icon}</span>
                        <div className="flex-1">
                          <div className="flex flex-wrap items-center gap-3 mb-2"><h4 className="font-bold text-slate-800 text-lg">{arch.id}: {arch.name}</h4><span className={`px-2 py-1 rounded text-xs font-semibold ${arch.type === 'Core' ? 'bg-purple-200 text-purple-800' : 'bg-emerald-200 text-emerald-800'}`}>{arch.type}</span></div>
                          <p className="text-sm text-slate-700 italic mb-3">"{arch.story}"</p>
                          <div className="mb-3">
                            <div className="text-xs font-semibold text-slate-600 mb-1">Common Variations:</div>
                            <div className="flex flex-wrap gap-2">{arch.variations.map((v, idx) => (<span key={idx} className="text-xs bg-white px-2 py-1 rounded border border-slate-200">{v}</span>))}</div>
                          </div>
                          <div className="flex items-center gap-2 text-xs text-slate-600 flex-wrap">
                            <span className="font-semibold">Tools from:</span>
                            {Object.keys(matrix).filter(k => k.endsWith(`-${arch.id}`)).map(k => {
                                const topicId = parseInt(k.split('-')[0]); const topic = topics.find(t => t.id === topicId); if (!topic) return null; const borderColor = topic.borderColor ? topic.borderColor.replace('300', '400') : 'border-slate-400';
                                return (<span key={k} className={`${topic.color} px-2 py-1 rounded border ${borderColor} font-medium`}>T{topicId}</span>);
                            })}
                          </div>
                        </div>
                      </div>
                    </div>
                  ))}
                </div>
                <div className="mt-6 p-4 bg-purple-50 border-l-4 border-purple-400 rounded">
                  <div className="flex items-start gap-3">
                    <AlertCircle className="text-purple-600 mt-0.5 flex-shrink-0" size={18} /><p className="text-sm text-slate-700"><strong>Purpose:</strong> Rapid question-type recognition in combat. First question when seeing a problem: "Which game is this?" not "Which chapter?"</p>
                  </div>
                </div>
              </div>
            )}

            {activeView === 'directory' && (
              <div className="bg-white rounded-lg p-4 sm:p-6 shadow-inner animate-fade-in">
                 {/* ... Directory View Content ... */}
                <div className="flex items-start gap-4 mb-6">
                  <List className="text-gray-600 mt-1 flex-shrink-0" size={24} />
                  <div>
                    <h3 className="text-xl font-bold text-slate-800">Atomic Knowledge Module (AKM) Directory</h3>
                    <p className="text-slate-600 text-sm mt-1">The definitive index mapping syllabus topics to their corresponding note modules.</p>
                  </div>
                </div>
                <div className="overflow-x-auto">
                  <table className="w-full border-collapse">
                    <thead className="bg-slate-100">
                      <tr>
                        <th className="p-3 text-left text-sm font-semibold text-slate-600 border-b-2 border-slate-200">Syllabus Topic</th>
                        <th className="p-3 text-left text-sm font-semibold text-slate-600 border-b-2 border-slate-200">AKM #</th>
                        <th className="p-3 text-left text-sm font-semibold text-slate-600 border-b-2 border-slate-200">AKM Title (Atomic Note)</th>
                      </tr>
                    </thead>
                    <tbody>
                      {groupedAkms.map((topic, index) => (
                        <React.Fragment key={topic.id}>
                          {topic.akms.map((akm, akmIndex) => (
                            <tr key={akm.id} className="hover:bg-slate-50">
                              {akmIndex === 0 && (
                                <td rowSpan={topic.akms.length} className={`p-3 border-b border-slate-200 font-bold text-sm ${topic.textColor} align-top`}>
                                  T{topic.id}: {topic.name}
                                </td>
                              )}
                              <td className="p-3 border-b border-slate-200 font-mono text-sm text-slate-700">
                                <a href={`${atomicNotesURL}#AKM-${akm.id}`} target="_blank" rel="noopener noreferrer" className="text-blue-600 hover:underline">{akm.id}</a>
                              </td>
                              <td className="p-3 border-b border-slate-200 text-sm text-slate-800">{akm.title}</td>
                            </tr>
                          ))}
                        </React.Fragment>
                      ))}
                    </tbody>
                  </table>
                </div>
              </div>
            )}
          </div>
          
          {/* Bottom Summary */}
          <div className="mt-8 p-6 bg-gradient-to-r from-slate-800 to-slate-700 rounded-lg text-white">
            <h4 className="font-bold text-lg mb-3">ðŸŽ¯ Design Logic Summary</h4>
            <div className="grid sm:grid-cols-3 gap-4 text-sm">
              <div><div className="font-bold mb-1 text-blue-300">Warehouse Perspective</div><div className="text-slate-300">Ensures systematic & complete learning (Knowledge Input)</div></div>
              <div><div className="font-bold mb-1 text-purple-300">Battlefield Perspective</div><div className="text-slate-300">Ensures efficient & accurate problem-solving (Question Output)</div></div>
              <div><div className="font-bold mb-1 text-emerald-300">Matrix Perspective</div><div className="text-slate-300">Reveals mapping relationships (Integration & Transfer)</div></div>
            </div>
            <div className="mt-4 pt-4 border-t border-slate-600"><p className="text-xs text-slate-400 italic">Master Insight: Novices use "Warehouse only" (learn chapter â†’ do chapter). Experts switch to "Battlefield" (see question â†’ identify pattern). Champions integrate "Matrix" (one tool â†’ multiple contexts).</p></div>
          </div>
          <style>{`
            @keyframes fade-in { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
            .animate-fade-in { animation: fade-in 0.4s ease-out forwards; }
            @keyframes fade-in-fast { from { opacity: 0; } to { opacity: 1; } }
            .animate-fade-in-fast { animation: fade-in-fast 0.2s ease-out forwards; }
          `}</style>
        </div>
      );
    };

    const container = document.getElementById('root');
    const root = ReactDOM.createRoot(container);
    root.render(<PhysicsKnowledgeMatrix />);
  </script>
</body>
</html>

