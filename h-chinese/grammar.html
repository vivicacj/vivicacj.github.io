<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>O-Levelç—…å¥ä¿®æ”¹é«˜åˆ†ä½œæˆ˜å®¤ (æ•°æ®é©±åŠ¨ç‰ˆ)</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/echarts/5.4.3/echarts.min.js"></script>
    <style>
        :root {
            --primary-color: #6a82fb;
            --secondary-color: #fc5c7d;
            --text-color: #34495e;
            --light-gray: #f7f9fc;
            --border-color: #e0e6f1;
            --bg-gradient: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            --shadow-light: 0 4px 15px rgba(0, 0, 0, 0.08);
            --shadow-medium: 0 8px 25px rgba(0, 0, 0, 0.1);
        }
        * { margin: 0; padding: 0; box-sizing: border-box; }
        html { scroll-behavior: smooth; }
        body {
            font-family: 'Microsoft YaHei', 'PingFang SC', -apple-system, sans-serif;
            line-height: 1.8;
            color: var(--text-color);
            background-color: var(--light-gray);
        }
        .container { max-width: 1100px; margin: 0 auto; padding: 25px; }
        
        .header {
            text-align: center; padding: 40px 20px; margin-bottom: 40px;
            background: var(--bg-gradient); border-radius: 20px;
            color: white; box-shadow: var(--shadow-medium);
        }
        .header h1 { font-size: 2.8rem; margin-bottom: 10px; text-shadow: 2px 2px 5px rgba(0,0,0,0.2); }
        .header p { font-size: 1.1rem; opacity: 0.9; }

        .section {
            background: white; border-radius: 20px; padding: 30px;
            margin-bottom: 40px; box-shadow: var(--shadow-medium);
        }
        .section h2 { font-size: 2rem; margin-bottom: 25px; padding-bottom: 10px; border-bottom: 3px solid var(--primary-color); display: inline-block; }

        #dashboard-chart { width: 100%; height: 400px; margin-bottom: 20px; }
        .strategy-cards { display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 20px; }
        .strategy-card {
            padding: 25px; border-radius: 15px; background-color: var(--light-gray);
            border-left: 5px solid; transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        .strategy-card:hover { transform: translateY(-5px); box-shadow: var(--shadow-light); }
        .strategy-card h3 { margin-bottom: 10px; font-size: 1.5rem; }
        .strategy-card p { font-size: 1rem; color: #555; }
        .card-attack { border-color: #e74c3c; }
        .card-stable { border-color: #2ecc71; }
        .card-defend { border-color: #f39c12; }

        .accordion-item { border: 1px solid var(--border-color); border-radius: 15px; margin-bottom: 15px; overflow: hidden; }
        .accordion-header {
            background: white; width: 100%; padding: 15px 20px; border: none;
            text-align: left; font-size: 1.2rem; font-weight: bold; cursor: pointer;
            display: flex; justify-content: space-between; align-items: center;
            transition: background-color 0.3s ease;
        }
        .accordion-header:hover { background-color: #f1f3f8; }
        .accordion-header.active { background-color: #e9ecf5; }
        .accordion-header .arrow { font-size: 1.5rem; transition: transform 0.3s ease; }
        .accordion-header.active .arrow { transform: rotate(180deg); }
        .accordion-content {
            max-height: 0; overflow: hidden; transition: max-height 0.4s ease-in-out;
            background-color: var(--light-gray); padding: 0 25px;
        }
        .accordion-content .content-inner { padding: 25px 0; }
        .accordion-content h4 { margin-top: 20px; margin-bottom: 10px; font-size: 1.2rem; color: var(--primary-color); }
        .accordion-content h4:first-child { margin-top: 0; }
        .example { border: 1px solid var(--border-color); padding: 15px; border-radius: 10px; margin-bottom: 15px; background: white; }
        .example strong { color: #d35400; }
        .reveal-btn {
            background-color: var(--primary-color); color: white; border: none; padding: 8px 15px;
            border-radius: 20px; cursor: pointer; margin-top: 10px; transition: background-color 0.3s;
        }
        .reveal-btn:hover { background-color: #556ee6; }
        .correction-panel {
            margin-top: 15px; padding: 15px; background: #e8f5e9;
            border-left: 4px solid #4caf50; border-radius: 5px; display: none;
        }
        
        .future-watchlist {
            margin-top: 30px; padding: 25px; border-radius: 15px;
            background: linear-gradient(135deg, #1f283e 0%, #2c3e50 100%);
            color: #f0f0f0; border: 1px solid #4a6fa5;
        }
        .future-watchlist h4 { font-size: 1.4rem; color: #a7c5eb; margin-bottom: 15px; }
        .future-watchlist p { margin-bottom: 10px; font-size: 0.95rem; line-height: 1.7; }
        .future-watchlist strong { color: #f7b733; }
        .future-watchlist .example-sentence { background: rgba(255, 255, 255, 0.1); padding: 10px; border-radius: 5px; font-style: italic; }

        .watchlist-summary-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
        }
        .watchlist-summary-card {
            background-color: var(--light-gray);
            border-radius: 15px;
            padding: 20px;
            border-left: 5px solid;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        .watchlist-summary-card:hover {
            transform: translateY(-5px) scale(1.02);
            box-shadow: var(--shadow-light);
        }
        .watchlist-summary-card .parent-type {
            font-weight: bold;
            font-size: 1.1rem;
            margin-bottom: 5px;
        }
        .watchlist-summary-card .future-type {
            font-size: 1.3rem;
            font-weight: bold;
            margin-bottom: 10px;
        }
        .watchlist-summary-card .action-text {
            color: #777;
            font-size: 0.9rem;
        }

        #quiz-controls { background: var(--light-gray); padding: 20px; border-radius: 15px; margin-bottom: 25px; }
        .checkbox-group { display: flex; flex-wrap: wrap; gap: 15px; margin-top: 15px; margin-bottom: 20px; }
        .checkbox-group label {
            display: flex; align-items: center; background: white; padding: 10px 15px;
            border-radius: 20px; cursor: pointer; box-shadow: var(--shadow-light); transition: all 0.3s ease;
        }
        .checkbox-group input { margin-right: 8px; }
        .checkbox-group label:hover { background: #e9ecf5; }
        #start-quiz-btn {
            width: 100%; padding: 15px; font-size: 1.2rem; font-weight: bold;
            background: var(--secondary-color); color: white; border: none; border-radius: 10px;
            cursor: pointer; transition: background-color 0.3s;
        }
        #start-quiz-btn:hover { background: #d64561; }
        #quiz-container { display: none; margin-top: 20px; }
        #quiz-sentence {
            font-size: 1.3rem; padding: 20px; margin-bottom: 20px;
            background: #fffbe6; border-left: 5px solid #f1c40f; border-radius: 10px;
        }
        #quiz-options { display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 10px; }
        .option-btn {
            padding: 12px; font-size: 1rem; background: white; border: 2px solid var(--border-color);
            border-radius: 10px; cursor: pointer; transition: all 0.2s ease;
        }
        .option-btn:hover { border-color: var(--primary-color); background: #e9ecf5; }
        #quiz-feedback { margin-top: 20px; padding: 15px; border-radius: 10px; display: none; }
        .correct-feedback { background: #e8f5e9; border: 1px solid #4caf50; color: #1e4620; }
        .incorrect-feedback { background: #fbe9e7; border: 1px solid #e74c3c; color: #8c2b20; }
        #quiz-feedback a { color: var(--primary-color); font-weight: bold; text-decoration: underline; }
        
        footer { text-align: center; padding: 30px; margin-top: 40px; color: #777; }

        @media (max-width: 768px) {
            .header h1 { font-size: 2.2rem; }
            .section { padding: 20px; }
            .section h2 { font-size: 1.6rem; }
        }
    </style>
</head>
<body>

    <div class="container">
        <header class="header">
            <h1>O-Levelç—…å¥ä¿®æ”¹é«˜åˆ†ä½œæˆ˜å®¤</h1>
            <p>åŸºäº 2016-2023 å…«å¹´çœŸé¢˜æ•°æ®é©±åŠ¨ï¼Œç²¾å‡†æ‰“å‡»æ¯ä¸€ä¸ªè€ƒç‚¹</p>
        </header>

        <section id="dashboard" class="section">
            <h2><span style="font-size: 2.5rem;">ğŸ“Š</span> ä½œæˆ˜æ€»è§ˆï¼šè€ƒæƒ…çƒ­åŠ›å›¾ä¸æˆ˜ç•¥</h2>
            <div id="dashboard-chart"></div>
            <div class="strategy-cards">
                <div class="strategy-card card-attack"><h3>ğŸ¯ ä¸»æ”» (80%ç²¾åŠ›)</h3><p>M-æ­é…ä¸å½“ & M-è¯­åºä¸å½“ã€‚æ”»å…‹é«˜é¢‘éš¾é¢˜ã€‚</p></div>
                <div class="strategy-card card-stable"><h3>âœ… ç¨³æ‹¿ (ç¡®ä¿æ»¡åˆ†)</h3><p>R-ç”¨è¯é‡å¤ & O-æˆåˆ†æ®‹ç¼ºã€‚åŸºç¡€é€åˆ†é¡¹ã€‚</p></div>
                <div class="strategy-card card-defend"><h3>ğŸ›¡ï¸ é˜²å®ˆ (é¿å…å¤±åˆ†)</h3><p>I-ç”¨è¯ä¸å½“ & L-å…³è”è¯é”™è¯¯ã€‚ä½é¢‘é«˜å±é¡¹ã€‚</p></div>
            </div>
        </section>

        <section id="deep-dive" class="section">
            <h2><span style="font-size: 2.5rem;">ğŸ”¬</span> æ·±åº¦è§£æï¼šé«˜é¢‘é™·é˜±æ¢æŸ¥å™¨</h2>
            <div class="accordion" id="accordion-container"></div>
        </section>
        
        <section id="future-watchlist-summary" class="section">
            <h2><span style="font-size: 2.5rem;">ğŸš¨</span> æœªæ¥æˆ˜ç•¥é¢„è­¦ï¼šæ½œåœ¨è€ƒæ ¸å­ç±»</h2>
            <p style="margin-top:-20px; margin-bottom:25px;">ä¸ºå†²å‡»A1ï¼Œå¿…é¡»é¢„å¤‡çš„"æ–°å˜ç§"è€ƒç‚¹ã€‚ç‚¹å‡»å¡ç‰‡å¯è·³è½¬è‡³è¯¦ç»†è§£æã€‚</p>
            <div class="watchlist-summary-grid" id="watchlist-summary-container">
                <!-- Summary cards will be generated by JavaScript -->
            </div>
        </section>

        <section id="practice-zone" class="section">
            <h2><span style="font-size: 2.5rem;">ğŸ¯</span> æ™ºèƒ½è®­ç»ƒåœºï¼šä¸“é¡¹ç»ƒä¹ ç”Ÿæˆå™¨</h2>
            <div id="quiz-controls">
                <p><strong>ç¬¬ä¸€æ­¥ï¼šé€‰æ‹©ä½ æƒ³è®­ç»ƒçš„é”™è¯¯ç±»å‹</strong></p>
                <div class="checkbox-group" id="quiz-type-selector"></div>
                <button id="start-quiz-btn"><strong>ç¬¬äºŒæ­¥ï¼šå¼€å§‹ä¸“é¡¹ç»ƒä¹ ï¼</strong></button>
            </div>
            <div id="quiz-container">
                <p id="quiz-progress" style="font-weight: bold; margin-bottom: 15px;"></p>
                <div id="quiz-sentence"></div>
                <div id="quiz-options"></div>
                <div id="quiz-feedback"></div>
            </div>
        </section>

        <footer>
            <p>&copy; 2024 O-Level ç—…å¥ä¿®æ”¹é«˜åˆ†ä½œæˆ˜å®¤ | ç¥ä½ è€ƒè¯•æˆåŠŸï¼</p>
        </footer>
    </div>

<script>
document.addEventListener('DOMContentLoaded', () => {

    const errorData = [
        { 
            code: 'M-Mismatch', name: 'æ­é…ä¸å½“', count: 12, rating: 'â˜…â˜…â˜…â˜…â˜… (æœ€é«˜é¢‘/æœ€éš¾)',
            description: 'è¯è¯­é—´çš„ç»„åˆå…³ç³»ä¸ç¬¦åˆè¯­è¨€ä¹ æƒ¯ï¼Œæ˜¯è€ƒæŸ¥ç»¼åˆè¯­æ„Ÿçš„æ ¸å¿ƒã€‚',
            subtypes: [
                { name: 'åŠ¨å®¾æ­é…', trap: 'åŠ¨è¯çš„æ ¸å¿ƒåŠŸèƒ½ä¸å®¾è¯­çš„å±æ€§ä¸åŒ¹é…ã€‚', examples: [{ year: 2023, sentence: 'è¿™å¯¹å‚èµ›è€…çš„æ°´å‡†è¿›è¡Œäº†å…¨é¢è€ƒéªŒã€‚', correction: '"è€ƒéªŒ"çš„å¯¹è±¡æ˜¯èƒ½åŠ›/æ„å¿—ï¼Œè€Œä¸æ˜¯"æ°´å‡†"ï¼ˆç»“æœï¼‰ã€‚åº”æ”¹ä¸º `è€ƒéªŒ...èƒ½åŠ›`ã€‚' }, { year: 2016, sentence: '...åŠ æ·±äº†å›½é™…ç«äº‰åŠ›ã€‚', correction: '"åŠ æ·±"ç”¨äºæ·±åº¦ï¼Œè€Œ"ç«äº‰åŠ›"æ˜¯ç­‰çº§ã€‚åº”æ”¹ä¸º `æå‡/åŠ å¼º...ç«äº‰åŠ›`ã€‚' }] },
                { name: 'ä¿®é¥°è¯­æ­é…', trap: 'å‰¯è¯/å½¢å®¹è¯çš„"æ°”è´¨"ä¸å®ƒä¿®é¥°çš„è¯è¯­ä¸ç¬¦ã€‚', examples: [{ year: 2019, sentence: '...æ€»ä¼šå‘¨å¯†åœ°æ²Ÿé€šã€‚', correction: '"å‘¨å¯†åœ°"ç”¨äºè®¡åˆ’ï¼Œè€Œ"æ²Ÿé€š"éœ€è¦ `å……åˆ†åœ°`ã€‚' }] }
            ],
            futureWatch: { name: 'åŠ¨è¡¥æ­é…ä¸å½“', rationale: 'åŠ¨è¡¥ç»“æ„æ˜¯æ±‰è¯­çš„æ ¸å¿ƒï¼Œè€ƒå¯Ÿå®ƒå¯ä»¥æå‡å¯¹å­¦ç”Ÿç»¼åˆè¯­æ³•èƒ½åŠ›çš„æµ‹è¯•æ·±åº¦ã€‚', example: 'âœ– ä»–æŠŠé—®é¢˜å›ç­”å¾—å¾ˆå¯¹ã€‚ â†’ âœ” ä»–æŠŠé—®é¢˜å›ç­”å¾—å¾ˆæ­£ç¡®ã€‚', strategy: 'å…³æ³¨"å¾—"å­—çŸ­è¯­ï¼Œç§¯ç´¯å¸¸ç”¨åŠ¨è¡¥æ­é…ã€‚' }
        },
        { 
            code: 'R-Repetition', name: 'ç”¨è¯é‡å¤', count: 9, rating: 'â˜…â˜…â˜…â˜…â˜… (æœ€é«˜é¢‘/åŸºç¡€)',
            description: 'è¯­ä¹‰æˆ–ç»“æ„å†—ä½™ï¼Œæ˜¯ç—…å¥ä¸­æœ€åŸºç¡€ä¹Ÿæœ€å®¹æ˜“è¢«å‘ç°çš„ç±»å‹ã€‚',
            subtypes: [
                 { name: 'è¯­ä¹‰é‡å¤', trap: 'ä¸¤ä¸ªæ„æ€ç›¸è¿‘çš„è¯å åŠ ä½¿ç”¨ã€‚', examples: [{ year: 2017, sentence: 'æˆ‘ä»¬å¿…é¡»è®©æ‰€æœ‰æ¯ä¸ªäºº...', correction: '"æ‰€æœ‰"å’Œ"æ¯ä¸ª"é‡å¤ï¼Œåˆ é™¤å…¶ä¸€ã€‚' }] },
                 { name: 'ç»“æ„èµ˜ä½™', trap: 'å¥å¼ç»“æ„ä¸Šçš„ä¸å¿…è¦é‡å¤ï¼Œç‰¹åˆ«æ˜¯"åŠ¨è¯å¥—åŠ¨è¯"ã€‚', examples: [{ year: 2023, sentence: 'ä»Šå¹´çš„å†³èµ›å°†ä»¥å…¨æ–°çš„å½¢å¼è¿›è¡Œä¸¾åŠã€‚', correction: '"è¿›è¡Œ"å’Œ"ä¸¾åŠ"åŠŸèƒ½é‡å¤ï¼Œåº”æ”¹ä¸º `å°†ä»¥...å½¢å¼ä¸¾åŠ` æˆ– `å°†ä¸¾åŠ`ã€‚' }] }
            ],
            futureWatch: { name: 'èŒƒç•´é‡å¤', rationale: 'è¿™ç§é‡å¤æ›´éšè”½ï¼Œå®ƒä¸æ˜¯è¯ä¹‰é‡å¤ï¼Œè€Œæ˜¯é€»è¾‘èŒƒç•´ä¸Šçš„é‡å ã€‚', example: 'âœ– å„å¼å„æ ·çš„ç§ç±»æœ‰å¾ˆå¤šã€‚ â†’ âœ” æ ·å¼æœ‰å¾ˆå¤šã€‚', strategy: 'åŸ¹å…»å¯¹å¥å­é€»è¾‘å±‚æ¬¡çš„æ•æ„Ÿåº¦ï¼Œæ£€æŸ¥æ˜¯å¦å­˜åœ¨"å¤§æ¦‚å¿µ"å’Œå°æ¦‚å¿µçš„ä¸å¿…è¦é‡å ã€‚' }
        },
        { 
            code: 'M-Misordering', name: 'è¯­åºä¸å½“', count: 8, rating: 'â˜…â˜…â˜…â˜…â˜† (é«˜é¢‘/è¾ƒéš¾)',
            description: 'å¥å­æˆåˆ†æ’åˆ—é¡ºåºé”™è¯¯ï¼Œå½±å“é€»è¾‘å’Œè¡¨è¾¾æ¸…æ™°åº¦ã€‚',
            subtypes: [
                 { name: 'ä¿®é¥°è¯­é”™ä½', trap: 'æ—¶é—´ã€åœ°ç‚¹ã€æ–¹å¼ç­‰çŠ¶è¯­æ”¾é”™äº†ä½ç½®ã€‚', examples: [{ year: 2018, sentence: '...ç»¼åˆä¹é¾„æŠ¤ç†ä¸­å¿ƒå¼€å¹•æ˜¨å¤©ã€‚', correction: 'æ—¶é—´çŠ¶è¯­"æ˜¨å¤©"åº”åœ¨åŠ¨è¯å‰ï¼Œæ”¹ä¸º `æ˜¨å¤©å¼€å¹•`ã€‚' }] },
                 { name: 'å¥å¼æ‚ç³…', trap: 'æŠŠä¸¤ç§è¯´æ³•æ··åœ¨ä¸€èµ·ã€‚', examples: [{ year: 2016, sentence: 'è€Œæ˜¯äººä»¬åº”è¯¥å¿ƒæ€å’Œè¡Œä¸ºæ”¹å˜ã€‚', correction: 'æ··åˆäº†"äººä»¬åº”è¯¥æ”¹å˜å¿ƒæ€å’Œè¡Œä¸º"å’Œ"æ”¹å˜çš„æ˜¯å¿ƒæ€å’Œè¡Œä¸º"ã€‚åº”æ”¹ä¸º `è€Œæ˜¯äººä»¬åº”è¯¥æ”¹å˜å¿ƒæ€å’Œè¡Œä¸º`ã€‚' }] }
            ],
            futureWatch: { name: 'å¤šé‡å®šè¯­/çŠ¶è¯­çš„å†…éƒ¨é€»è¾‘æ’åº', rationale: 'éšç€å¥å­å¤æ‚åº¦æå‡ï¼Œè¿™æ˜¯å¿…ç„¶çš„è¿›åŒ–æ–¹å‘ã€‚å®ƒè€ƒå¯Ÿçš„ä¸ä»…æ˜¯è¯­æ³•ä½ç½®ï¼Œæ›´æ˜¯é€»è¾‘çš„ä¸¥å¯†æ€§ã€‚', example: 'âœ– ä¸€ä½æ¥è‡ªä¸­å›½çš„å¹´è½»æœ‰ä¸ºçš„æ•°å­¦å®¶... â†’ âœ” ä¸€ä½æœ‰ä¸ºçš„æ¥è‡ªä¸­å›½çš„å¹´è½»æ•°å­¦å®¶... (é€»è¾‘æ’åºåº”ä¸ºï¼š[è¡¨å±æ€§] > [è¡¨å½’å±] > [è¡¨çŠ¶æ€])', strategy: 'å­¦ä¹ "ç¦»ä¸­å¿ƒè¯­è¶Šè¿‘çš„å®šè¯­å…³ç³»è¶Šç´§å¯†"ç­‰æ ¸å¿ƒæ’åºåŸåˆ™ã€‚' }
        },
        { 
            code: 'O-Omission', name: 'æˆåˆ†æ®‹ç¼º', count: 7, rating: 'â˜…â˜…â˜…â˜…â˜† (é«˜é¢‘/æ˜“å¿½ç•¥)',
            description: 'å¥å­ç¼ºå°‘ä¸»è°“å®¾ç­‰å¿…è¦æˆåˆ†ï¼Œåœ¨é•¿å¥ä¸­å°¤å…¶å®¹æ˜“è¢«å¿½ç•¥ã€‚',
            subtypes: [
                { name: 'ç¼ºå°‘å®¾è¯­', trap: 'åŠç‰©åŠ¨è¯åé¢æ²¡æœ‰åŠ¨ä½œçš„å¯¹è±¡ã€‚', examples: [{ year: 2017, sentence: 'åœ¨ä»»ä½•é˜¶æ®µéƒ½èƒ½å¤ŸæŠŠæ¡å­¦ä¹ ã€‚', correction: '"æŠŠæ¡"ä»€ä¹ˆï¼Ÿç¼ºå°‘å®¾è¯­"æœºä¼š"ã€‚åº”æ”¹ä¸º `æŠŠæ¡å­¦ä¹ çš„æœºä¼š`ã€‚' }] },
                { name: 'ç¼ºå°‘ä¸»è¯­', trap: 'å¥å­çš„ååŠéƒ¨åˆ†ï¼Œç‰¹åˆ«æ˜¯ç”¨äº†"å°†"ã€"ä¼š"ç­‰è¯æ—¶ï¼Œä¸¢å¤±é€»è¾‘ä¸»è¯­ã€‚', examples: [{ year: 2018, sentence: 'è®©å¹´é•¿è€…éƒ½å®‰å¿ƒå…»è€ï¼Œå°†å¸®åŠ©ä»–ä»¬æå‡ç”Ÿæ´»ç´ è´¨ã€‚', correction: '"ä»€ä¹ˆ"å°†å¸®åŠ©ï¼Ÿç¼ºå°‘ä¸»è¯­ã€‚åº”æ”¹ä¸º `è¿™é¡¹æªæ–½å°†å¸®åŠ©ä»–ä»¬...`ã€‚' }] }
            ],
            futureWatch: { name: 'ç¼ºå°‘å¿…è¦çš„ä»‹è¯', rationale: 'ä»‹è¯çš„ç¼ºå¤±åœ¨å£è¯­ä¸­å¾ˆå¸¸è§ï¼Œä½†åœ¨ä¹¦é¢è¯­ä¸­ä¼šé€ æˆç»“æ„æ®‹ç¼ºæˆ–æ­§ä¹‰ï¼Œæ˜¯è€ƒå¯Ÿ"è¯­ä½“è§„èŒƒæ„è¯†"çš„ç»ä½³è€ƒç‚¹ã€‚', example: 'âœ– æˆ‘æ¯•ä¸šæ¸…åå¤§å­¦ã€‚ â†’ âœ” æˆ‘æ¯•ä¸šäºæ¸…åå¤§å­¦ã€‚', strategy: 'ç§¯ç´¯å¸¸ç”¨ä»‹è¯ï¼ˆåœ¨ã€äºã€ä»ã€å‘ã€æŠŠã€è¢«ï¼‰çš„ä½¿ç”¨åœºæ™¯ã€‚' }
        },
        { 
            code: 'I-Improper', name: 'ç”¨è¯ä¸å½“', count: 6, rating: 'â˜…â˜…â˜…â˜†â˜† (ä¸­é¢‘/ä¸­ç­‰)',
            description: 'æ‰€é€‰è¯è¯­çš„è‡ªèº«å±æ€§ï¼ˆè¯ä¹‰ã€è‰²å½©ã€é€‚ç”¨å¯¹è±¡ï¼‰ä¸è¯­å¢ƒä¸ç¬¦ã€‚',
            subtypes: [
                { name: 'è¯ä¹‰/å¯¹è±¡è¯¯ç”¨', trap: 'è¯è¯­çš„æ„ä¹‰æˆ–é€‚ç”¨å¯¹è±¡é”™è¯¯ã€‚', examples: [{ year: 2018, sentence: 'ä¸­å¿ƒä¹Ÿä¼šå®‰æ’ä¸“è½¦ä¼ é€è¿™äº›è¡ŒåŠ¨ä¸ä¾¿çš„å¹´é•¿è€…ã€‚', correction: '"ä¼ é€"ç”¨äºç‰©å“æˆ–æ•°æ®ï¼Œå¯¹äººåº”ç”¨ `æ¥é€`ã€‚' }] }
            ],
            futureWatch: { name: 'è¯­ä½“é£æ ¼ä¸å½“', rationale: 'O-Levelè€ƒè¯•è¶Šæ¥è¶Šé‡è§†ä¹¦é¢è¯­çš„è§„èŒƒæ€§ã€‚åœ¨æ­£å¼è¯­å¢ƒä¸­ä½¿ç”¨è¿‡äºå£è¯­åŒ–æˆ–ç½‘ç»œåŒ–çš„è¯è¯­ï¼Œå°†æˆä¸ºæ–°çš„å¤±åˆ†ç‚¹ã€‚', example: 'âœ– è¿™é¡¹è®¡åˆ’çš„æˆæœéå¸¸ç»™åŠ›ã€‚ â†’ âœ” è¿™é¡¹è®¡åˆ’çš„æˆæœéå¸¸æ˜¾è‘—ã€‚', strategy: 'å»ºç«‹"æ­£å¼è¯­ä½“è¯æ±‡åº“"ï¼Œæœ‰æ„è¯†åœ°ç”¨ä¹¦é¢è¯­è¯æ±‡æ›¿æ¢å£è¯­è¯ã€‚' }
        },
        { 
            code: 'L-Linking', name: 'å…³è”è¯é”™è¯¯', count: 2, rating: 'â˜…â˜…â˜†â˜†â˜† (ä½é¢‘/é«˜å±)',
            description: 'å…³è”è¯æ­é…é”™è¯¯æˆ–é€»è¾‘çŸ›ç›¾ï¼Œè™½ç„¶è€ƒå¾—å°‘ï¼Œä½†é”™äº†åŸºæœ¬å°±æ˜¯é›¶åˆ†ã€‚',
            subtypes: [
                { name: 'æ­é…é”™è¯¯', trap: 'ä½¿ç”¨äº†ä¸æˆå¯¹æˆ–é”™è¯¯çš„å…³è”è¯ç»„åˆã€‚', examples: [{ year: 2023, sentence: '...å› ä¸ºä¸ä»…é¢˜æ•°å¢åŠ äº†ï¼Œæ—¶é—´åè€Œç¼©çŸ­äº†ã€‚', correction: '"ä¸ä»…...åè€Œ"æ­é…é”™è¯¯ï¼Œé€’è¿›å…³ç³»åº”ä¸º `ä¸ä»…...è€Œä¸”...`ã€‚' }, { year: 2019, sentence: '...å³ä½¿ä»–ä»¬ç¼ºä¹è¿™æ–¹é¢çš„ç»éªŒï¼Œæˆ‘ä»¬å¹¶æ¬¢è¿ã€‚', correction: '"å³ä½¿...å¹¶"æ­é…é”™è¯¯ï¼Œè®©æ­¥å…³ç³»åº”ä¸º `å³ä½¿...ä¹Ÿ...`ã€‚' }] }
            ],
            futureWatch: { name: 'æ»¥ç”¨å…³è”è¯', rationale: 'è¿™æ˜¯å­¦ç”Ÿå†™ä½œä¸­çš„é«˜é¢‘é”™è¯¯ã€‚ä¸ºäº†è®©é€»è¾‘çœ‹ä¼¼æ¸…æ™°ï¼Œè€Œæ»¥ç”¨å…³è”è¯ï¼Œåè€Œå¯¼è‡´å¥å­ä¸è‡ªç„¶ã€‚', example: 'âœ– å› ä¸ºä»–å¾ˆåŠªåŠ›ï¼Œæ‰€ä»¥æœ€ç»ˆä»–å–å¾—äº†æˆåŠŸã€‚ â†’ (è¿‡äºå•°å—¦) âœ” ä»–å¾ˆåŠªåŠ›ï¼Œæœ€ç»ˆå–å¾—äº†æˆåŠŸã€‚', strategy: 'å­¦ä¹ åœ¨ä¸Šä¸‹æ–‡æ¸…æ™°çš„æƒ…å†µä¸‹ï¼Œé€‚å½“çœç•¥å…³è”è¯ï¼Œè®©è¡¨è¾¾æ›´ç²¾ç‚¼ã€‚' }
        }
    ];

    const dashboardChart = echarts.init(document.getElementById('dashboard-chart'));
    dashboardChart.setOption({
        tooltip: { trigger: 'axis', axisPointer: { type: 'shadow' } },
        grid: { left: '10%', right: '15%', bottom: '3%', top: '3%', containLabel: true },
        xAxis: { type: 'value', boundaryGap: [0, 0.01] },
        yAxis: { 
            type: 'category', 
            data: errorData.map(d => d.name).reverse(),
            axisLabel: { 
                interval: 0,
                fontSize: 12
            }
        },
        series: [{
            name: '8å¹´å‡ºç°æ€»æ¬¡æ•°', type: 'bar',
            data: errorData.map(d => d.count).reverse(),
            itemStyle: {
                color: new echarts.graphic.LinearGradient(1, 0, 0, 0, [{ offset: 0, color: '#fc5c7d' }, { offset: 1, color: '#6a82fb' }]),
                borderRadius: [0, 5, 5, 0]
            },
            label: { show: true, position: 'right', formatter: '{c}æ¬¡' }
        }]
    });

    dashboardChart.on('click', (params) => {
        const targetData = errorData.find(d => d.name === params.name);
        if (targetData) jumpToAccordion(targetData.code);
    });

    const accordionContainer = document.getElementById('accordion-container');
    const watchlistSummaryContainer = document.getElementById('watchlist-summary-container');
    const colors = ['#e74c3c', '#9b59b6', '#3498db', '#1abc9c', '#f39c12', '#34495e'];

    errorData.forEach((error, index) => {
        // Populate Accordion
        let subtypesHtml = '';
        error.subtypes.forEach(subtype => {
            let examplesHtml = '';
            subtype.examples.forEach(ex => {
                examplesHtml += `<div class="example"><p><strong>ç—…å¥ (${ex.year}çœŸé¢˜):</strong> ${ex.sentence}</p><button class="reveal-btn">æ˜¾ç¤ºä¿®æ­£ä¸è§£æ</button><div class="correction-panel"><p><strong>é™·é˜±è§£æ:</strong> ${ex.correction}</p></div></div>`;
            });
            subtypesHtml += `<h4>${subtype.name}</h4><p><strong>å¸¸è§é™·é˜±:</strong> ${subtype.trap}</p>${examplesHtml}`;
        });

        let futureWatchHtml = '';
        if (error.futureWatch) {
            const fw = error.futureWatch;
            futureWatchHtml = `<div class="future-watchlist"><h4>ğŸš¨ æœªæ¥é¢„è­¦å­ç±»: ${fw.name}</h4><p><strong>é¢„æµ‹ç†ç”±:</strong> ${fw.rationale}</p><p><strong>é¢„è­¦ç¤ºä¾‹:</strong> <span class="example-sentence">${fw.example}</span></p><p><strong>å¤‡è€ƒç­–ç•¥:</strong> ${fw.strategy}</p></div>`;
        }

        const item = document.createElement('div');
        item.className = 'accordion-item';
        item.id = error.code;
        item.innerHTML = `
            <button class="accordion-header">
                <span><strong>${error.code.split('-')[0]} - ${error.name}</strong> (${error.count}æ¬¡) <small>${error.rating}</small></span>
                <span class="arrow">â–¼</span>
            </button>
            <div class="accordion-content"><div class="content-inner"><p>${error.description}</p>${subtypesHtml}${futureWatchHtml}</div></div>
        `;
        accordionContainer.appendChild(item);

        // Populate Future Watchlist Summary
        if (error.futureWatch) {
            const card = document.createElement('div');
            card.className = 'watchlist-summary-card';
            card.style.borderColor = colors[index % colors.length];
            card.innerHTML = `
                <div class="parent-type" style="color:${colors[index % colors.length]}">${error.name}</div>
                <div class="future-type">${error.futureWatch.name}</div>
                <div class="action-text">ç‚¹å‡»æŸ¥çœ‹è¯¦ç»†è§£æ &raquo;</div>
            `;
            card.onclick = () => jumpToAccordion(error.code);
            watchlistSummaryContainer.appendChild(card);
        }
    });
    
    function jumpToAccordion(id) {
        const element = document.getElementById(id);
        if (element) {
            const header = element.querySelector('.accordion-header');
            const content = header.nextElementSibling;
            
            // Open accordion if not already open
            if (!header.classList.contains('active')) {
                header.classList.add('active');
                content.style.maxHeight = content.scrollHeight + 'px';
            }
            
            // Scroll to the element
            element.scrollIntoView({ behavior: 'smooth', block: 'center' });
        }
    }

    // Make jumpToAccordion globally accessible
    window.jumpToAccordion = jumpToAccordion;

    document.querySelectorAll('.accordion-header').forEach(header => {
        header.addEventListener('click', () => {
            const content = header.nextElementSibling;
            const isActive = header.classList.contains('active');
            header.classList.toggle('active');
            content.style.maxHeight = isActive ? null : content.scrollHeight + 'px';
        });
    });

    document.querySelectorAll('.reveal-btn').forEach(btn => {
        btn.addEventListener('click', (e) => {
            e.stopPropagation();
            const panel = btn.nextElementSibling;
            const accordionContent = btn.closest('.accordion-content');
            const isVisible = panel.style.display === 'block';
            panel.style.display = isVisible ? 'none' : 'block';
            btn.textContent = isVisible ? 'æ˜¾ç¤ºä¿®æ­£ä¸è§£æ' : 'éšè—ä¿®æ­£ä¸è§£æ';
            if (accordionContent.style.maxHeight) {
                accordionContent.style.maxHeight = accordionContent.scrollHeight + 'px';
            }
        });
    });

    const quizTypeSelector = document.getElementById('quiz-type-selector');
    errorData.forEach(error => {
        const label = document.createElement('label');
        label.innerHTML = `<input type="checkbox" value="${error.code}"> ${error.name}`;
        quizTypeSelector.appendChild(label);
    });

    const quizBank = [];
    errorData.forEach(error => {
        error.subtypes.forEach(subtype => {
            subtype.examples.forEach(ex => {
                quizBank.push({ sentence: ex.sentence, correctCode: error.code, explanation: ex.correction });
            });
        });
    });

    let currentQuestions = [], currentQuestionIndex = 0;
    const startQuizBtn = document.getElementById('start-quiz-btn');
    const quizContainer = document.getElementById('quiz-container');
    const quizProgress = document.getElementById('quiz-progress');
    const quizSentence = document.getElementById('quiz-sentence');
    const quizOptions = document.getElementById('quiz-options');
    const quizFeedback = document.getElementById('quiz-feedback');

    startQuizBtn.addEventListener('click', () => {
        const selectedTypes = Array.from(document.querySelectorAll('#quiz-type-selector input:checked')).map(cb => cb.value);
        if (selectedTypes.length === 0) { alert('è¯·è‡³å°‘é€‰æ‹©ä¸€ä¸ªé”™è¯¯ç±»å‹å¼€å§‹ç»ƒä¹ ï¼'); return; }
        currentQuestions = quizBank.filter(q => selectedTypes.includes(q.correctCode));
        if (currentQuestions.length === 0) { alert('æŠ±æ­‰ï¼Œæ‰€é€‰ç±»å‹æš‚æ—¶æ²¡æœ‰å¯¹åº”çš„ç»ƒä¹ é¢˜ã€‚'); return; }
        currentQuestions.sort(() => Math.random() - 0.5);
        currentQuestionIndex = 0;
        quizContainer.style.display = 'block';
        displayQuestion();
    });

    function displayQuestion() {
        if (currentQuestionIndex >= currentQuestions.length) { endQuiz(); return; }
        const question = currentQuestions[currentQuestionIndex];
        quizProgress.textContent = `ç¬¬ ${currentQuestionIndex + 1} / ${currentQuestions.length} é¢˜`;
        quizSentence.textContent = question.sentence;
        quizOptions.innerHTML = '';
        quizFeedback.style.display = 'none';
        errorData.forEach(error => {
            const button = document.createElement('button');
            button.className = 'option-btn';
            button.textContent = `${error.code.split('-')[0]} - ${error.name}`;
            button.onclick = () => checkAnswer(error.code, question);
            quizOptions.appendChild(button);
        });
    }

    function checkAnswer(selectedCode, question) {
        quizFeedback.style.display = 'block';
        if (selectedCode === question.correctCode) {
            quizFeedback.className = 'correct-feedback';
            quizFeedback.innerHTML = `<strong>âœ… å›ç­”æ­£ç¡®ï¼</strong>`;
        } else {
            quizFeedback.className = 'incorrect-feedback';
            quizFeedback.innerHTML = `<strong>âŒ å›ç­”é”™è¯¯ã€‚</strong> æ­£ç¡®ç±»å‹æ˜¯ <strong>${question.correctCode}</strong>ã€‚<br><strong>è§£æï¼š</strong>${question.explanation}<br><a href="javascript:void(0)" onclick="jumpToAccordion('${question.correctCode}')">ç‚¹å‡»è¿™é‡Œï¼Œå¤ä¹ è¿™ä¸ªçŸ¥è¯†ç‚¹ã€‚</a>`;
        }
        document.querySelectorAll('.option-btn').forEach(btn => btn.disabled = true);
        setTimeout(() => {
            currentQuestionIndex++;
            displayQuestion();
        }, 3000);
    }

    function endQuiz() {
        quizContainer.innerHTML = `<h3 style="text-align:center; color: var(--primary-color);">ğŸ‰ æ­å–œä½ ï¼Œå®Œæˆäº†æœ¬æ¬¡ä¸“é¡¹ç»ƒä¹ ï¼</h3><p style="text-align:center;">ä½ å¯ä»¥é‡æ–°é€‰æ‹©ç±»å‹å¼€å§‹æ–°ä¸€è½®ç»ƒä¹ ã€‚</p>`;
    }

});
</script>
</body>
</html>