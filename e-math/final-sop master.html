<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Final Sprint SOP Master - Complete</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Arial, sans-serif;
            line-height: 1.6;
            color: #333;
            background: #f5f5f5;
        }
        
        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 2rem;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            position: sticky;
            top: 0;
            z-index: 100;
        }
        
        .header h1 {
            font-size: 2rem;
            margin-bottom: 0.5rem;
        }
        
        .search-box {
            display: flex;
            gap: 1rem;
            margin-top: 1rem;
        }
        
        .search-box input {
            flex: 1;
            padding: 0.75rem;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
        }
        
        .search-box button {
            padding: 0.75rem 1.5rem;
            background: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: bold;
            color: #667eea;
            transition: all 0.2s;
        }
        
        .search-box button:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            display: grid;
            grid-template-columns: 300px 1fr;
            gap: 2rem;
            padding: 2rem;
        }
        
        .sidebar {
            background: white;
            padding: 1.5rem;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            height: fit-content;
            position: sticky;
            top: 180px;
        }
        
        .category-title {
            font-size: 1.2rem;
            font-weight: bold;
            color: #dc3545;
            margin: 1.5rem 0 1rem 0;
            padding-bottom: 0.5rem;
            border-bottom: 2px solid #dc3545;
        }
        
        .category-title.satellite {
            color: #28a745;
            border-bottom-color: #28a745;
        }
        
        .nav-item {
            padding: 0.75rem;
            margin: 0.5rem 0;
            cursor: pointer;
            border-radius: 8px;
            transition: all 0.2s;
            font-size: 0.95rem;
            border-left: 3px solid transparent;
        }
        
        .nav-item:hover {
            background: #f0f0f0;
            transform: translateX(4px);
        }
        
        .nav-item.active {
            background: #667eea;
            color: white;
            font-weight: bold;
            border-left-color: #764ba2;
        }
        
        .content {
            background: white;
            padding: 2rem;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        
        .topic-section {
            margin-bottom: 3rem;
            display: none;
        }
        
        .topic-section.active {
            display: block;
            animation: fadeIn 0.3s;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .topic-title {
            font-size: 2rem;
            color: #667eea;
            margin-bottom: 1rem;
            padding-bottom: 1rem;
            border-bottom: 3px solid #667eea;
        }
        
        .topic-badge {
            display: inline-block;
            padding: 0.25rem 0.75rem;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: bold;
            margin-left: 1rem;
            vertical-align: middle;
        }
        
        .badge-core {
            background: #dc3545;
            color: white;
        }
        
        .badge-satellite {
            background: #28a745;
            color: white;
        }
        
        .sop-block {
            margin: 2rem 0;
            padding: 1.5rem;
            background: #f9f9f9;
            border-left: 4px solid #667eea;
            border-radius: 8px;
        }
        
        .sop-title {
            font-size: 1.5rem;
            color: #333;
            margin-bottom: 1rem;
            font-weight: bold;
        }
        
        .sop-goal, .sop-triggers, .sop-steps {
            margin: 1rem 0;
        }
        
        .label {
            font-weight: bold;
            color: #667eea;
            display: inline-block;
            margin-bottom: 0.5rem;
        }
        
        .steps-list {
            margin-left: 1.5rem;
        }
        
        .steps-list li {
            margin: 0.75rem 0;
            padding-left: 0.5rem;
        }
        
        .pitfalls {
            background: #fff3cd;
            padding: 1rem;
            border-radius: 8px;
            border-left: 4px solid #ffc107;
            margin: 1rem 0;
        }
        
        .pitfalls-title {
            font-weight: bold;
            color: #856404;
            margin-bottom: 0.5rem;
        }
        
        .critical, .fatal {
            color: #dc3545;
            font-weight: bold;
        }
        
        .typical {
            color: #fd7e14;
            font-weight: bold;
        }
        
        .protips {
            background: #d1ecf1;
            padding: 1rem;
            border-radius: 8px;
            border-left: 4px solid #17a2b8;
            margin: 1rem 0;
        }
        
        .protips-title {
            font-weight: bold;
            color: #0c5460;
            margin-bottom: 0.5rem;
        }
        
        .formula {
            background: #e9ecef;
            padding: 0.5rem 1rem;
            border-radius: 4px;
            font-family: 'Courier New', monospace;
            display: inline-block;
            margin: 0.25rem 0;
        }
        
        .highlight {
            background: yellow;
            padding: 2px 4px;
            border-radius: 3px;
        }
        
        .intro-box {
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            padding: 1.5rem;
            border-radius: 12px;
            margin-bottom: 2rem;
            border-left: 5px solid #667eea;
        }

        /* Custom Message Box Styles */
        .message-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.2s, visibility 0.2s;
        }
        .message-overlay.show {
            opacity: 1;
            visibility: visible;
        }
        .message-box {
            background: white;
            padding: 2rem;
            border-radius: 12px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
            text-align: center;
            max-width: 400px;
            transform: scale(0.9);
            transition: transform 0.2s;
        }
        .message-overlay.show .message-box {
            transform: scale(1);
        }
        .message-box p {
            margin-bottom: 1.5rem;
            font-size: 1.1rem;
        }
        .message-box button {
            padding: 0.75rem 2rem;
            background: #667eea;
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: bold;
            transition: background 0.2s;
        }
        .message-box button:hover {
            background: #764ba2;
        }
        
        @media (max-width: 1024px) {
            .container {
                grid-template-columns: 1fr;
            }
            
            .sidebar {
                position: static;
                top: auto;
            }
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>Final Sprint SOP Master Version</h1>
        <p>Complete Mathematical Procedures Reference Guide - Core & Satellite Topics</p>
        <div class="search-box">
            <input type="text" id="searchInput" placeholder="Search SOPs, formulas, pitfalls, keywords...">
            <button onclick="searchContent()">Search</button>
            <button onclick="clearSearch()">Clear</button>
        </div>
    </div>
    
    <div class="container">
        <div class="sidebar">
            <div class="category-title">CORE TOPICS</div>
            <div class="nav-item active" onclick="showTopic('trig', this)">Trigonometry Application</div>
            <div class="nav-item" onclick="showTopic('quadratic', this)">Quadratic Functions & Graphs</div>
            <div class="nav-item" onclick="showTopic('algebra', this)">Algebraic Manipulation</div>
            <div class="nav-item" onclick="showTopic('proof', this)">Geometric Proofs</div>
            
            <div class="category-title satellite">SATELLITE TOPICS</div>
            <div class="nav-item" onclick="showTopic('coord', this)">Coordinate Geometry</div>
            <div class="nav-item" onclick="showTopic('mens', this)">Mensuration</div>
            <div class="nav-item" onclick="showTopic('ineq', this)">Inequalities</div>
            <div class="nav-item" onclick="showTopic('indices', this)">Indices & Standard Form</div>
            <div class="nav-item" onclick="showTopic('stats', this)">Statistics & Probability</div>
            <div class="nav-item" onclick="showTopic('ratio', this)">Ratio & Percentage</div>
        </div>
        
        <div class="content" id="mainContent">
            <!-- CORE TOPIC 1: Trigonometry -->
            <div class="topic-section active" id="trig">
                <h2 class="topic-title">Trigonometry Application in Context<span class="topic-badge badge-core">CORE TOPIC</span></h2>
                
                <div class="intro-box">
                    <strong>To Dennis:</strong> This is a high-stakes topic. Master these two SOPs and you'll handle any bearing, elevation, or 3D problem with confidence.
                </div>
                
                <div class="sop-block">
                    <h3 class="sop-title">SOP 1: Solving 2D Bearing / Geometry Problems</h3>
                    
                    <div class="sop-goal">
                        <span class="label">Goal:</span> To find unknown lengths or angles in non-right-angled triangles.
                    </div>
                    
                    <div class="sop-triggers">
                        <span class="label">Triggers:</span> "Bearing of...", "due east", diagrams with non-right-angled triangles.
                    </div>
                    
                    <div class="sop-steps">
                        <span class="label">Steps:</span>
                        <ol class="steps-list">
                            <li><strong>Annotate & Convert:</strong> Draw all North lines. Convert all given bearings into <strong>internal angles</strong> of the key triangle using parallel line properties.</li>
                            <li><strong>Assess the Triangle:</strong> Count the knowns. Do you have <strong>SAS/SSS</strong> or <strong>AAS/SSA</strong>?</li>
                            <li><strong>Select the Right Tool:</strong>
                                <ul>
                                    <li>If SAS or SSS, use the <strong>Cosine Rule</strong>.</li>
                                    <li>If AAS or SSA, use the <strong>Sine Rule</strong>.</li>
                                </ul>
                            </li>
                            <li><strong>Calculate & Check:</strong> Solve for the unknown. If finding an angle with the Sine Rule, check if an obtuse angle (180° - θ) is possible.</li>
                        </ol>
                    </div>
                    
                    <div class="pitfalls">
                        <div class="pitfalls-title">Common Pitfalls & Pro-Tips:</div>
                        <ul>
                            <li><span class="fatal">Fatal Error:</span> Mixing up the Sine Rule and Cosine Rule formulas.</li>
                            <li><span class="typical">Typical Error:</span> Forgetting to check for the obtuse angle possibility when using Sine Rule.</li>
                        </ul>
                    </div>
                    
                    <div class="protips">
                        <div class="protips-title">Pro-Tip:</div>
                        <p>Memorize this: "<strong>If the problem gives you three sides (SSS) or a Side-Angle-Side 'sandwich' (SAS), you need the Cosine Rule. For almost everything else, it's the Sine Rule.</strong>"</p>
                    </div>
                </div>
                
                <div class="sop-block">
                    <h3 class="sop-title">SOP 2: Solving 3D Elevation & Depression Problems</h3>
                    
                    <div class="sop-goal">
                        <span class="label">Goal:</span> To solve problems involving height and angles in a 3D context.
                    </div>
                    
                    <div class="sop-triggers">
                        <span class="label">Triggers:</span> "angle of elevation", "angle of depression", "height of...", "vertical".
                    </div>
                    
                    <div class="sop-steps">
                        <span class="label">Steps:</span>
                        <ol class="steps-list">
                            <li><strong>Deconstruct into 2 Planes:</strong> Isolate the problem into:
                                <ul>
                                    <li>A <strong>2D problem on the horizontal ground</strong>.</li>
                                    <li>A <strong>2D right-angled triangle in the vertical plane</strong>.</li>
                                </ul>
                            </li>
                            <li><strong>Solve the Ground Problem First:</strong> Use <strong>SOP 1</strong> to find the crucial <strong>horizontal distance</strong> between the observer and the base of the vertical object. This is your "bridge" value.</li>
                            <li><strong>Solve the Vertical Problem:</strong> Draw the right-angled triangle. Label the height and the "bridge" value (horizontal distance). Use basic <strong>SOH CAH TOA</strong> to find the final answer.</li>
                        </ol>
                    </div>
                    
                    <div class="pitfalls">
                        <div class="pitfalls-title">Common Pitfalls & Pro-Tips:</div>
                        <ul>
                            <li><span class="fatal">Fatal Error:</span> Trying to use Sine/Cosine Rule directly in the 3D space.</li>
                            <li><span class="typical">Typical Error:</span> Confusing horizontal distance with slant distance.</li>
                        </ul>
                    </div>
                    
                    <div class="protips">
                        <div class="protips-title">Pro-Tip:</div>
                        <p>Always break it down. Your mantra should be: "<strong>First the map, then the wall.</strong>" (First solve the ground plan, then solve the vertical plane)</p>
                    </div>
                </div>
            </div>
            
            <!-- CORE TOPIC 2: Quadratic Functions -->
            <div class="topic-section" id="quadratic">
                <h2 class="topic-title">Quadratic Functions & Graphs<span class="topic-badge badge-core">CORE TOPIC</span></h2>
                
                <div class="intro-box">
                    <strong>To Dennis:</strong> Quadratics appear in multiple contexts. These SOPs will help you handle any question about parabolas, turning points, and sketching.
                </div>
                
                <div class="sop-block">
                    <h3 class="sop-title">SOP 1: Completing the Square (y = a(x-h)² + k)</h3>
                    
                    <div class="sop-goal">
                        <span class="label">Goal:</span> Convert a quadratic from general form to vertex form to find the turning point.
                    </div>
                    
                    <div class="sop-triggers">
                        <span class="label">Triggers:</span> "Express in the form...", "find the coordinates of the turning/minimum/maximum point".
                    </div>
                    
                    <div class="sop-steps">
                        <span class="label">Steps:</span>
                        <ol class="steps-list">
                            <li>Factor out the coefficient <span class="formula">a</span> from the first two terms: <span class="formula">a(x² + (b/a)x) + c</span>.</li>
                            <li>Inside the bracket, add and subtract <span class="formula">(b/2a)²</span>.</li>
                            <li>Factor the perfect square: <span class="formula">a[(x + b/2a)² - (b/2a)²] + c</span>.</li>
                            <li>Expand and simplify to get the final form <span class="formula">a(x - h)² + k</span>.</li>
                        </ol>
                    </div>
                    
                    <div class="pitfalls">
                        <div class="pitfalls-title">Common Pitfalls & Pro-Tips:</div>
                        <ul>
                            <li><span class="fatal">Fatal Error:</span> Sign errors when <span class="formula">a</span> is negative.</li>
                            <li><span class="typical">Typical Error:</span> Forgetting to distribute <span class="formula">a</span> to the subtracted term.</li>
                        </ul>
                    </div>
                    
                    <div class="protips">
                        <div class="protips-title">Pro-Tip:</div>
                        <p>Be extremely careful when distributing the <span class="formula">a</span> back into the subtracted term. Write each step explicitly.</p>
                    </div>
                </div>
                
                <div class="sop-block">
                    <h3 class="sop-title">SOP 2: Sketching the Graph</h3>
                    
                    <div class="sop-goal">
                        <span class="label">Goal:</span> Draw an accurate sketch showing all key features.
                    </div>
                    
                    <div class="sop-triggers">
                        <span class="label">Triggers:</span> "Sketch the graph..."
                    </div>
                    
                    <div class="sop-steps">
                        <span class="label">Steps:</span>
                        <ol class="steps-list">
                            <li><strong>Find the y-intercept:</strong> Set <span class="formula">x = 0</span>.</li>
                            <li><strong>Find the x-intercepts:</strong> Set <span class="formula">y = 0</span> and solve using the quadratic formula or factorisation.</li>
                            <li><strong>Find the Turning Point:</strong> Use <strong>SOP 1</strong>.</li>
                            <li><strong>Plot & Sketch:</strong> Mark all three sets of points and draw a smooth parabola. Label the axis of symmetry <span class="formula">x = h</span>.</li>
                        </ol>
                    </div>
                    
                    <div class="pitfalls">
                        <div class="pitfalls-title">Common Pitfalls & Pro-Tips:</div>
                        <ul>
                            <li><span class="fatal">Fatal Error:</span> Mixing up the coordinates of the vertex with the values in the vertex form. <span class="formula">y = (x-3)² - 5</span> has a vertex at <span class="formula">(3, -5)</span>, not <span class="formula">(-3, -5)</span>.</li>
                            <li><span class="typical">Typical Error:</span> Forgetting to label the axis of symmetry.</li>
                        </ul>
                    </div>
                    
                    <div class="protips">
                        <div class="protips-title">Pro-Tip:</div>
                        <p>Before sketching, write down all key coordinates in a list to ensure none are forgotten.</p>
                    </div>
                </div>
            </div>
            
            <!-- CORE TOPIC 3: Algebraic Manipulation -->
            <div class="topic-section" id="algebra">
                <h2 class="topic-title">Comprehensive Algebraic Manipulation<span class="topic-badge badge-core">CORE TOPIC</span></h2>
                
                <div class="intro-box">
                    <strong>To Dennis:</strong> Algebraic fractions are everywhere. Master these procedures and you'll handle simplification, addition, subtraction, and equation-solving with confidence.
                </div>
                
                <div class="sop-block">
                    <h3 class="sop-title">SOP 1: Simplifying Algebraic Fractions</h3>
                    
                    <div class="sop-goal">
                        <span class="label">Goal:</span> Reduce algebraic fractions to their simplest form.
                    </div>
                    
                    <div class="sop-triggers">
                        <span class="label">Triggers:</span> "Simplify...", "Express in simplest form..."
                    </div>
                    
                    <div class="sop-steps">
                        <span class="label">Steps:</span>
                        <ol class="steps-list">
                            <li><strong>Factorize Completely:</strong> Factor both numerator and denominator as much as possible.</li>
                            <li><strong>Cancel Common Factors:</strong> Identify and cancel factors that appear in both numerator and denominator.</li>
                            <li><strong>Write Final Answer:</strong> Express the simplified fraction.</li>
                        </ol>
                    </div>
                    
                    <div class="pitfalls">
                        <div class="pitfalls-title">Common Pitfalls & Pro-Tips:</div>
                        <ul>
                            <li><span class="fatal">Fatal Error:</span> Canceling terms instead of factors (e.g., canceling x in (x+3)/x is WRONG).</li>
                            <li><span class="typical">Typical Error:</span> Missing common factors in quadratic expressions.</li>
                        </ul>
                    </div>
                    
                    <div class="protips">
                        <div class="protips-title">Pro-Tip:</div>
                        <p>Only factors (things multiplied) can be canceled, never terms (things added/subtracted). If unsure, factor completely first.</p>
                    </div>
                </div>
                
                <div class="sop-block">
                    <h3 class="sop-title">SOP 2: Adding & Subtracting Algebraic Fractions</h3>
                    
                    <div class="sop-goal">
                        <span class="label">Goal:</span> Combine algebraic fractions into a single fraction.
                    </div>
                    
                    <div class="sop-triggers">
                        <span class="label">Triggers:</span> "Simplify...", questions with + or - between fractions.
                    </div>
                    
                    <div class="sop-steps">
                        <span class="label">Steps:</span>
                        <ol class="steps-list">
                            <li><strong>Find the LCD (Lowest Common Denominator):</strong> Factor all denominators and identify the LCD.</li>
                            <li><strong>Convert Each Fraction:</strong> Multiply numerator and denominator by the necessary factor to reach the LCD.</li>
                            <li><strong>Combine:</strong> Add or subtract numerators, keep the common denominator.</li>
                            <li><strong>Simplify:</strong> Factor and cancel if possible using SOP 1.</li>
                        </ol>
                    </div>
                    
                    <div class="pitfalls">
                        <div class="pitfalls-title">Common Pitfalls & Pro-Tips:</div>
                        <ul>
                            <li><span class="fatal">Fatal Error:</span> Adding denominators (a/b + c/d ≠ (a+c)/(b+d)).</li>
                            <li><span class="typical">Typical Error:</span> Sign errors when distributing negative signs across numerators.</li>
                        </ul>
                    </div>
                    
                    <div class="protips">
                        <div class="protips-title">Pro-Tip:</div>
                        <p>When subtracting, put parentheses around the entire second numerator to avoid sign errors: (numerator1) - (numerator2).</p>
                    </div>
                </div>
                
                <div class="sop-block">
                    <h3 class="sop-title">SOP 3: Multiplying & Dividing Algebraic Fractions</h3>
                    
                    <div class="sop-goal">
                        <span class="label">Goal:</span> Multiply or divide algebraic fractions efficiently.
                    </div>
                    
                    <div class="sop-triggers">
                        <span class="label">Triggers:</span> × or ÷ symbols between fractions.
                    </div>
                    
                    <div class="sop-steps">
                        <span class="label">Steps:</span>
                        <ol class="steps-list">
                            <li><strong>For Division:</strong> Flip the second fraction and change to multiplication.</li>
                            <li><strong>Factor Everything:</strong> Factor all numerators and denominators before multiplying.</li>
                            <li><strong>Cancel Diagonally:</strong> Cancel common factors across numerators and denominators.</li>
                            <li><strong>Multiply What Remains:</strong> Multiply numerators together and denominators together.</li>
                        </ol>
                    </div>
                    
                    <div class="pitfalls">
                        <div class="pitfalls-title">Common Pitfalls & Pro-Tips:</div>
                        <ul>
                            <li><span class="fatal">Fatal Error:</span> Forgetting to flip the second fraction when dividing.</li>
                            <li><span class="typical">Typical Error:</span> Multiplying before factoring and canceling.</li>
                        </ul>
                    </div>
                    
                    <div class="protips">
                        <div class="protips-title">Pro-Tip:</div>
                        <p>Always factor first, then cancel. This saves massive amounts of calculation time and reduces errors.</p>
                    </div>
                </div>
                
                <div class="sop-block">
                    <h3 class="sop-title">SOP 4: Solving Equations with Algebraic Fractions</h3>
                    
                    <div class="sop-goal">
                        <span class="label">Goal:</span> Solve equations containing algebraic fractions.
                    </div>
                    
                    <div class="sop-triggers">
                        <span class="label">Triggers:</span> "Solve...", equations with fractions containing variables.
                    </div>
                    
                    <div class="sop-steps">
                        <span class="label">Steps:</span>
                        <ol class="steps-list">
                            <li><strong>Find the LCD:</strong> Identify the lowest common denominator of all fractions in the equation.</li>
                            <li><strong>Multiply Through:</strong> Multiply every term on both sides by the LCD to eliminate all fractions.</li>
                            <li><strong>Solve the Resulting Equation:</strong> Use standard algebraic techniques (expand, collect terms, solve).</li>
                            <li><strong>Check for Extraneous Solutions:</strong> Substitute back to ensure the solution doesn't make any denominator zero.</li>
                        </ol>
                    </div>
                    
                    <div class="pitfalls">
                        <div class="pitfalls-title">Common Pitfalls & Pro-Tips:</div>
                        <ul>
                            <li><span class="fatal">Fatal Error:</span> Forgetting to check if the solution makes any denominator zero (extraneous solution).</li>
                            <li><span class="typical">Typical Error:</span> Not multiplying ALL terms by the LCD.</li>
                        </ul>
                    </div>
                    
                    <div class="protips">
                        <div class="protips-title">Pro-Tip:</div>
                        <p>After solving, always plug your answer back into the original equation to verify it works and doesn't create division by zero.</p>
                    </div>
                </div>
            </div>
            
            <!-- CORE TOPIC 4: Geometric Proofs -->
            <div class="topic-section" id="proof">
                <h2 class="topic-title">Geometric Proofs & Similarity/Congruency<span class="topic-badge badge-core">CORE TOPIC</span></h2>
                
                <div class="intro-box">
                    <strong>To Dennis:</strong> Proofs require precise logical structure. Follow these SOPs exactly and you'll write bulletproof geometric arguments.
                </div>
                
                <div class="sop-block">
                    <h3 class="sop-title">SOP 1: Proving Similarity (AA)</h3>
                    
                    <div class="sop-goal">
                        <span class="label">Goal:</span> To prove that two triangles are similar.
                    </div>
                    
                    <div class="sop-triggers">
                        <span class="label">Triggers:</span> "Show that... are similar", "Prove that..."
                    </div>
                    
                    <div class="sop-steps">
                        <span class="label">Steps:</span>
                        <ol class="steps-list">
                            <li><strong>Identify the 2 triangles</strong> and write the opening statement: <span class="formula">In ΔABC and ΔXYZ,</span></li>
                            <li><strong>Find the 1st Pair of Equal Angles:</strong> Look for <strong>Common Angles</strong>, <strong>Vertically Opposite Angles</strong>, or angles from <strong>Parallel Lines</strong> (Alternate/Corresponding). State the reason clearly.</li>
                            <li><strong>Find the 2nd Pair of Equal Angles:</strong> Repeat the search.</li>
                            <li><strong>Write the Conclusion:</strong> <span class="formula">Therefore, ΔABC is similar to ΔXYZ (AA Similarity)</span>.</li>
                        </ol>
                    </div>
                    
                    <div class="pitfalls">
                        <div class="pitfalls-title">Common Pitfalls & Pro-Tips:</div>
                        <ul>
                            <li><span class="fatal">Fatal Error:</span> Mismatching the order of vertices in the final conclusion statement.</li>
                            <li><span class="typical">Typical Error:</span> Stating equal angles without giving proper geometric reasons.</li>
                        </ul>
                    </div>
                    
                    <div class="protips">
                        <div class="protips-title">Pro-Tip:</div>
                        <p>Before writing the conclusion, physically trace the two triangles with your finger to confirm the vertex correspondence.</p>
                    </div>
                </div>
                
                <div class="sop-block">
                    <h3 class="sop-title">SOP 2: Proving Congruency (SAS, SSS, ASA, RHS)</h3>
                    
                    <div class="sop-goal">
                        <span class="label">Goal:</span> To prove that two triangles are identical in shape and size.
                    </div>
                    
                    <div class="sop-triggers">
                        <span class="label">Triggers:</span> "Show that... are congruent", "Prove that..."
                    </div>
                    
                    <div class="sop-steps">
                        <span class="label">Steps:</span>
                        <ol class="steps-list">
                            <li><strong>Identify the 2 triangles</strong> and write the opening statement.</li>
                            <li><strong>Systematically search for 3 pieces of evidence:</strong> Look for equal sides (S) and equal angles (A) based on the given info, common sides/angles, or properties of shapes.</li>
                            <li><strong>Match the Condition:</strong> Determine if your evidence fits <strong>SAS, SSS, ASA, or RHS</strong>.</li>
                            <li><strong>Write the Conclusion:</strong> <span class="formula">Therefore, ΔABC ≅ ΔXYZ (Condition)</span>.</li>
                        </ol>
                    </div>
                    
                    <div class="pitfalls">
                        <div class="pitfalls-title">Common Pitfalls & Pro-Tips:</div>
                        <ul>
                            <li><span class="fatal">Fatal Error:</span> Trying to use "SSA" or "AAA" to prove congruency—they are not valid conditions.</li>
                            <li><span class="typical">Typical Error:</span> For SAS, the angle is not included between the two sides.</li>
                        </ul>
                    </div>
                    
                    <div class="protips">
                        <div class="protips-title">Pro-Tip:</div>
                        <p>For SAS, always double-check that the Angle (A) is <strong>INCLUDED</strong> between the two Sides (S).</p>
                    </div>
                </div>
            </div>
            
            <!-- SATELLITE TOPIC 1: Coordinate Geometry -->
            <div class="topic-section" id="coord">
                <h2 class="topic-title">Coordinate Geometry<span class="topic-badge badge-satellite">SATELLITE TOPIC</span></h2>
                
                <div class="sop-block">
                    <h3 class="sop-title">SOP 1: Equation of a Straight Line (y = mx + c)</h3>
                    
                    <div class="sop-goal">
                        <span class="label">Goal:</span> Find the equation connecting two points.
                    </div>
                    
                    <div class="sop-triggers">
                        <span class="label">Triggers:</span> "Find the equation of the line..."
                    </div>
                    
                    <div class="sop-steps">
                        <span class="label">Steps:</span>
                        <ol class="steps-list">
                            <li><strong>Find gradient:</strong> <span class="formula">m = (y₂ − y₁) ÷ (x₂ − x₁)</span></li>
                            <li><strong>Write partial equation:</strong> <span class="formula">y = mx + c</span></li>
                            <li><strong>Substitute one point</strong> to find c</li>
                            <li><strong>Write final equation</strong></li>
                        </ol>
                    </div>
                    
                    <div class="pitfalls">
                        <div class="pitfalls-title">⚠️ Common Pitfalls:</div>
                        <ul>
                            <li><span class="critical">Critical:</span> Swapping x/y values when substituting into y = mx + c</li>
                            <li><span class="typical">Typical:</span> Computing gradient with coordinates reversed</li>
                        </ul>
                    </div>
                    
                    <div class="protips">
                        <div class="protips-title">💡 Pro-Tips:</div>
                        <ul>
                            <li>Label points clearly (x₁, y₁), (x₂, y₂) before any calculation</li>
                            <li>After finding m, immediately write y = mx + c and then solve for c</li>
                        </ul>
                    </div>
                </div>
                
                <div class="sop-block">
                    <h3 class="sop-title">SOP 2: Parallel & Perpendicular Lines</h3>
                    
                    <div class="sop-goal">
                        <span class="label">Goal:</span> Find equation of a new line using gradient relations.
                    </div>
                    
                    <div class="sop-triggers">
                        <span class="label">Triggers:</span> Keywords "parallel to..." / "perpendicular to..."
                    </div>
                    
                    <div class="sop-steps">
                        <span class="label">Steps:</span>
                        <ol class="steps-list">
                            <li>Rearrange given line to y = mx + c and read gradient m₁</li>
                            <li>Determine new gradient:
                                <ul>
                                    <li>Parallel → <span class="formula">m₂ = m₁</span></li>
                                    <li>Perpendicular → <span class="formula">m₂ = −1/m₁</span></li>
                                </ul>
                            </li>
                            <li>Use SOP 1 with new m₂ and given point</li>
                        </ol>
                    </div>
                    
                    <div class="pitfalls">
                        <div class="pitfalls-title">⚠️ Common Pitfalls:</div>
                        <ul>
                            <li><span class="critical">Critical:</span> Forgetting to flip AND change sign for perpendicular gradient</li>
                            <li><span class="typical">Typical:</span> Not rearranging line before reading gradient</li>
                        </ul>
                    </div>
                    
                    <div class="protips">
                        <div class="protips-title">💡 Pro-Tips:</div>
                        <ul>
                            <li>Box the original m₁ before working</li>
                            <li>Once m₂ is set, jump directly into SOP 1 flow</li>
                        </ul>
                    </div>
                </div>
                
                <div class="sop-block">
                    <h3 class="sop-title">SOP 3: Length & Area on Coordinate Plane</h3>
                    
                    <div class="sop-goal">
                        <span class="label">Goal:</span> Find distances or triangle areas.
                    </div>
                    
                    <div class="sop-triggers">
                        <span class="label">Triggers:</span> "Find the length..." / "Find the area..."
                    </div>
                    
                    <div class="sop-steps">
                        <span class="label">Steps:</span>
                        <ol class="steps-list">
                            <li><strong>Distance:</strong> <span class="formula">√[(x₂ − x₁)² + (y₂ − y₁)²]</span></li>
                            <li><strong>Triangle with axis-aligned side:</strong> <span class="formula">½ × base × height</span></li>
                            <li><strong>General triangle:</strong> use Shoelace Formula</li>
                        </ol>
                    </div>
                    
                    <div class="pitfalls">
                        <div class="pitfalls-title">⚠️ Common Pitfalls:</div>
                        <ul>
                            <li><span class="critical">Critical:</span> Misordering coordinates in Shoelace → wrong area sign/magnitude</li>
                            <li><span class="typical">Typical:</span> Dropping negatives when squaring distances</li>
                        </ul>
                    </div>
                    
                    <div class="protips">
                        <div class="protips-title">💡 Pro-Tips:</div>
                        <ul>
                            <li>For Shoelace, write coordinates clockwise and repeat the first at the bottom</li>
                            <li>If any side is horizontal/vertical, always prefer ½×base×height</li>
                        </ul>
                    </div>
                </div>
            </div>
            
            <!-- SATELLITE TOPIC 2: Mensuration -->
            <div class="topic-section" id="mens">
                <h2 class="topic-title">Mensuration<span class="topic-badge badge-satellite">SATELLITE TOPIC</span></h2>
                
                <div class="sop-block">
                    <h3 class="sop-title">SOP 1: The Master SOP (All Problems)</h3>
                    
                    <div class="sop-goal">
                        <span class="label">Goal:</span> Avoid formula/unit mistakes.
                    </div>
                    
                    <div class="sop-triggers">
                        <span class="label">Triggers:</span> Any mensuration Q (area/volume).
                    </div>
                    
                    <div class="sop-steps">
                        <span class="label">Steps:</span>
                        <ol class="steps-list">
                            <li>Identify shape</li>
                            <li>Write formula first</li>
                            <li>List variables</li>
                            <li>Substitute</li>
                            <li>Check units/accuracy</li>
                        </ol>
                    </div>
                    
                    <div class="pitfalls">
                        <div class="pitfalls-title">⚠️ Common Pitfalls:</div>
                        <ul>
                            <li><span class="critical">Critical:</span> Forgetting units → lose A marks</li>
                            <li><span class="typical">Typical:</span> Substituting numbers before writing formula</li>
                        </ul>
                    </div>
                    
                    <div class="protips">
                        <div class="protips-title">💡 Pro-Tips:</div>
                        <ul>
                            <li>Write formula first (method marks secured)</li>
                            <li>Box final answer with units</li>
                        </ul>
                    </div>
                </div>
                
                <div class="sop-block">
                    <h3 class="sop-title">SOP 2: Similar Figures & Solids</h3>
                    
                    <div class="sop-goal">
                        <span class="label">Goal:</span> Use scaling correctly.
                    </div>
                    
                    <div class="sop-triggers">
                        <span class="label">Triggers:</span> Words "similar", diagrams with same shape/different size.
                    </div>
                    
                    <div class="sop-steps">
                        <span class="label">Steps:</span>
                        <ol class="steps-list">
                            <li>Find length ratio k</li>
                            <li>Square/cube if area/volume</li>
                            <li>Setup ratio</li>
                            <li>Solve</li>
                        </ol>
                    </div>
                    
                    <div class="pitfalls">
                        <div class="pitfalls-title">⚠️ Common Pitfalls:</div>
                        <ul>
                            <li><span class="critical">Critical:</span> Using length ratio directly for area/volume</li>
                            <li><span class="typical">Typical:</span> Swapping numerator/denominator in ratios</li>
                        </ul>
                    </div>
                    
                    <div class="protips">
                        <div class="protips-title">💡 Pro-Tips:</div>
                        <ul>
                            <li>Always write k first, then k² / k³ before numbers</li>
                            <li>Draw quick table: Length–Area–Volume</li>
                        </ul>
                    </div>
                </div>
                
                <div class="sop-block">
                    <h3 class="sop-title">SOP 3: Composite Solids</h3>
                    
                    <div class="sop-goal">
                        <span class="label">Goal:</span> TSA/Volume of combined shapes.
                    </div>
                    
                    <div class="sop-steps">
                        <span class="label">Steps:</span>
                        <ol class="steps-list">
                            <li>Deconstruct</li>
                            <li>Compute each part</li>
                            <li>Add exposed surfaces only</li>
                        </ol>
                    </div>
                    
                    <div class="pitfalls">
                        <div class="pitfalls-title">⚠️ Common Pitfalls:</div>
                        <ul>
                            <li><span class="critical">Critical:</span> Double-counting hidden/glued surfaces in TSA</li>
                            <li><span class="typical">Typical:</span> Mixing CSA and TSA</li>
                        </ul>
                    </div>
                    
                    <div class="protips">
                        <div class="protips-title">💡 Pro-Tips:</div>
                        <ul>
                            <li>List all faces, mark "hidden" vs "exposed"</li>
                            <li>Annotate each part separately before summing</li>
                        </ul>
                    </div>
                </div>
                
                <div class="sop-block">
                    <h3 class="sop-title">SOP 4: Sector & Segment</h3>
                    
                    <div class="sop-goal">
                        <span class="label">Goal:</span> Arc length, sector area, segment area.
                    </div>
                    
                    <div class="sop-steps">
                        <span class="label">Steps:</span>
                        <ol class="steps-list">
                            <li>Check angle unit</li>
                            <li>Apply correct formulas</li>
                            <li>For segment: Sector − Triangle</li>
                        </ol>
                    </div>
                    
                    <div class="pitfalls">
                        <div class="pitfalls-title">⚠️ Common Pitfalls:</div>
                        <ul>
                            <li><span class="critical">Critical:</span> Using degree formula with radian input (or vice-versa)</li>
                            <li><span class="typical">Typical:</span> Forgetting to subtract triangle when finding segment</li>
                        </ul>
                    </div>
                    
                    <div class="protips">
                        <div class="protips-title">💡 Pro-Tips:</div>
                        <ul>
                            <li>Circle angle unit at start</li>
                            <li>Always write "Segment = Sector − Triangle" before numbers</li>
                        </ul>
                    </div>
                </div>
            </div>

            <!-- SATELLITE TOPIC 3: Inequalities -->
            <div class="topic-section" id="ineq">
                <h2 class="topic-title">Inequalities<span class="topic-badge badge-satellite">SATELLITE TOPIC</span></h2>
                
                <div class="sop-block">
                    <h3 class="sop-title">SOP 1: Compound Inequalities</h3>
                    
                    <div class="sop-goal">
                        <span class="label">Goal:</span> Solve and express combined range.
                    </div>
                    
                    <div class="sop-triggers">
                        <span class="label">Triggers:</span> Two inequality signs.
                    </div>
                    
                    <div class="sop-steps">
                        <span class="label">Steps:</span>
                        <ol class="steps-list">
                            <li>Split</li>
                            <li>Solve</li>
                            <li>Flip if ÷ negative</li>
                            <li>Draw number line</li>
                            <li>Overlap</li>
                            <li>Write final</li>
                        </ol>
                    </div>
                    
                    <div class="pitfalls">
                        <div class="pitfalls-title">⚠️ Common Pitfalls:</div>
                        <ul>
                            <li><span class="critical">Critical:</span> Not flipping inequality when ÷ negative</li>
                            <li><span class="typical">Typical:</span> Wrong open/closed circle on number line</li>
                        </ul>
                    </div>
                    
                    <div class="protips">
                        <div class="protips-title">💡 Pro-Tips:</div>
                        <ul>
                            <li>Write banner note: "× or ÷ negative → flip sign"</li>
                            <li>Always draw number line before final form</li>
                        </ul>
                    </div>
                </div>
                
                <div class="sop-block">
                    <h3 class="sop-title">SOP 2: Modelling with Inequalities</h3>
                    
                    <div class="sop-goal">
                        <span class="label">Goal:</span> Translate words to inequalities.
                    </div>
                    
                    <div class="sop-triggers">
                        <span class="label">Triggers:</span> "at least", "no more than", etc.
                    </div>
                    
                    <div class="sop-steps">
                        <span class="label">Steps:</span>
                        <ol class="steps-list">
                            <li>Define variable</li>
                            <li>Translate keywords</li>
                            <li>Construct inequality</li>
                        </ol>
                    </div>
                    
                    <div class="pitfalls">
                        <div class="pitfalls-title">⚠️ Common Pitfalls:</div>
                        <ul>
                            <li><span class="critical">Critical:</span> Misinterpreting "at least/at most" signs</li>
                            <li><span class="typical">Typical:</span> Forgetting to define variable</li>
                        </ul>
                    </div>
                    
                    <div class="protips">
                        <div class="protips-title">💡 Pro-Tips:</div>
                        <ul>
                            <li>Underline keywords and directly write ≥, ≤, >, <</li>
                            <li>Start with "Let x = …" before building inequality</li>
                        </ul>
                    </div>
                </div>
                
                <div class="sop-block">
                    <h3 class="sop-title">SOP 3: Max/Min in a Range</h3>
                    
                    <div class="sop-goal">
                        <span class="label">Goal:</span> Find extreme values.
                    </div>
                    
                    <div class="sop-steps">
                        <span class="label">Steps:</span>
                        <ol class="steps-list">
                            <li>List boundaries</li>
                            <li>Analyze expression</li>
                            <li>Choose correct combo</li>
                            <li>Calculate</li>
                        </ol>
                    </div>
                    
                    <div class="pitfalls">
                        <div class="pitfalls-title">⚠️ Common Pitfalls:</div>
                        <ul>
                            <li><span class="critical">Critical:</span> Picking wrong boundary combo → completely wrong extreme</li>
                            <li><span class="typical">Typical:</span> Forgetting odd powers keep sign (e.g. (−9)³ = −729)</li>
                        </ul>
                    </div>
                    
                    <div class="protips">
                        <div class="protips-title">💡 Pro-Tips:</div>
                        <ul>
                            <li>Write 2×2 boundary table for x/y</li>
                            <li>Do quick sanity check with approximate values</li>
                        </ul>
                    </div>
                </div>
            </div>
            
            <!-- SATELLITE TOPIC 4: Indices & Standard Form -->
            <div class="topic-section" id="indices">
                <h2 class="topic-title">Indices & Standard Form<span class="topic-badge badge-satellite">SATELLITE TOPIC</span></h2>
                
                <div class="sop-block">
                    <h3 class="sop-title">SOP 1: Simplify Complex Expressions</h3>
                    
                    <div class="pitfalls">
                        <div class="pitfalls-title">⚠️ Pitfalls & Pro-Tips:</div>
                        <ul>
                            <li><span class="critical">Critical:</span> Treating negative indices as negatives instead of reciprocals</li>
                            <li><span class="typical">Typical:</span> Forgetting to distribute power to coefficients</li>
                            <li>💡 Convert roots → fractional indices first, separate coefficient from power</li>
                        </ul>
                    </div>
                </div>
                
                <div class="sop-block">
                    <h3 class="sop-title">SOP 2: Solve Exponential Equations</h3>
                    
                    <div class="pitfalls">
                        <div class="pitfalls-title">⚠️ Pitfalls & Pro-Tips:</div>
                        <ul>
                            <li><span class="critical">Critical:</span> Failing to unify base before equating indices</li>
                            <li><span class="typical">Typical:</span> Forgetting fractional/negative power meanings</li>
                            <li>💡 Always rewrite all numbers as powers of prime base first</li>
                        </ul>
                    </div>
                </div>
                
                <div class="sop-block">
                    <h3 class="sop-title">SOP 3: "+ / −" in Exponential Equations</h3>
                    
                    <div class="pitfalls">
                        <div class="pitfalls-title">⚠️ Pitfalls & Pro-Tips:</div>
                        <ul>
                            <li><span class="critical">Critical:</span> Wrongly applying index laws to sums/differences</li>
                            <li><span class="typical">Typical:</span> Forgetting to factor out common term</li>
                            <li>💡 Treat repeated exponentials like like-terms ("apples"), then simplify</li>
                        </ul>
                    </div>
                </div>
                
                <div class="sop-block">
                    <h3 class="sop-title">SOP 4: Standard Form Calculations</h3>
                    
                    <div class="pitfalls">
                        <div class="pitfalls-title">⚠️ Pitfalls & Pro-Tips:</div>
                        <ul>
                            <li><span class="critical">Critical:</span> Adding/subtracting without aligning powers of 10</li>
                            <li><span class="typical">Typical:</span> Leaving final answer with A not in [1,10)</li>
                            <li>💡 Always unify exponent first, then adjust to standard form</li>
                        </ul>
                    </div>
                </div>
            </div>
            
            <!-- SATELLITE TOPIC 5: Statistics & Probability -->
            <div class="topic-section" id="stats">
                <h2 class="topic-title">Statistics & Probability<span class="topic-badge badge-satellite">SATELLITE TOPIC</span></h2>
                
                <div class="sop-block">
                    <h3 class="sop-title">SOP 1: Stem-and-Leaf</h3>
                    
                    <div class="pitfalls">
                        <div class="pitfalls-title">⚠️ Pitfalls:</div>
                        <ul>
                            <li><span class="critical">Critical:</span> Forgetting to average 2 middle values (even N)</li>
                            <li><span class="typical">Typical:</span> Counting N wrong</li>
                        </ul>
                    </div>
                    
                    <div class="protips">
                        <div class="protips-title">💡 Pro-Tips:</div>
                        <ul>
                            <li>Write N at top before median; note Median=(a+b)/2 if N even</li>
                        </ul>
                    </div>
                </div>
                
                <div class="sop-block">
                    <h3 class="sop-title">SOP 2: Grouped Frequency Tables</h3>
                    
                    <div class="pitfalls">
                        <div class="pitfalls-title">⚠️ Pitfalls:</div>
                        <ul>
                            <li><span class="critical">Critical:</span> Using class boundaries instead of midpoints</li>
                            <li><span class="typical">Typical:</span> Forgetting to compute fx column</li>
                        </ul>
                    </div>
                    
                    <div class="protips">
                        <div class="protips-title">💡 Pro-Tips:</div>
                        <ul>
                            <li>Always add Midpoint & fx columns</li>
                        </ul>
                    </div>
                </div>
                
                <div class="sop-block">
                    <h3 class="sop-title">SOP 3: Probability Basics</h3>
                    
                    <div class="pitfalls">
                        <div class="pitfalls-title">⚠️ Pitfalls:</div>
                        <ul>
                            <li><span class="critical">Critical:</span> Miscounting outcomes in compound "and/or"</li>
                            <li><span class="typical">Typical:</span> Forgetting to simplify final fraction</li>
                        </ul>
                    </div>
                    
                    <div class="protips">
                        <div class="protips-title">💡 Pro-Tips:</div>
                        <ul>
                            <li>Always list outcomes explicitly; never do mentally</li>
                        </ul>
                    </div>
                </div>
            </div>
            
            <!-- SATELLITE TOPIC 6: Ratio & Percentage -->
            <div class="topic-section" id="ratio">
                <h2 class="topic-title">Ratio & Percentage in Context<span class="topic-badge badge-satellite">SATELLITE TOPIC</span></h2>
                
                <div class="sop-block">
                    <h3 class="sop-title">SOP 1: Map Scale</h3>
                    
                    <div class="pitfalls">
                        <div class="pitfalls-title">⚠️ Pitfalls:</div>
                        <ul>
                            <li><span class="critical">Critical:</span> Using length scale for area</li>
                            <li><span class="typical">Typical:</span> Forgetting to square/cube for areas/volumes</li>
                        </ul>
                    </div>
                    
                    <div class="protips">
                        <div class="protips-title">💡 Pro-Tips:</div>
                        <ul>
                            <li>Always write both length & area scales before solving</li>
                        </ul>
                    </div>
                </div>
                
                <div class="sop-block">
                    <h3 class="sop-title">SOP 2: Percentage Change / Reverse</h3>
                    
                    <div class="pitfalls">
                        <div class="pitfalls-title">⚠️ Pitfalls:</div>
                        <ul>
                            <li><span class="critical">Critical:</span> Multiplying instead of dividing when finding original value</li>
                            <li><span class="typical">Typical:</span> Wrongly setting "100%" to new value</li>
                        </ul>
                    </div>
                    
                    <div class="protips">
                        <div class="protips-title">💡 Pro-Tips:</div>
                        <ul>
                            <li>Underline reference 100% before starting</li>
                        </ul>
                    </div>
                </div>
                
                <div class="sop-block">
                    <h3 class="sop-title">SOP 3: Simple & Compound Interest</h3>
                    
                    <div class="pitfalls">
                        <div class="pitfalls-title">⚠️ Pitfalls:</div>
                        <ul>
                            <li><span class="critical">Critical:</span> Forgetting to adjust R & T for compounding (rate ÷ n, time × n)</li>
                            <li><span class="typical">Typical:</span> Confusing interest vs total amount</li>
                        </ul>
                    </div>
                    
                    <div class="protips">
                        <div class="protips-title">💡 Pro-Tips:</div>
                        <ul>
                            <li>Immediately note n, then write R→R/n, T→nT before formula</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Custom Message Box HTML -->
    <div class="message-overlay" id="messageOverlay">
        <div class="message-box">
            <p id="messageText"></p>
            <button onclick="closeMessage()">OK</button>
        </div>
    </div>
    
    <script>
        function showTopic(topicId, element) {
            document.querySelectorAll('.topic-section').forEach(section => {
                section.classList.remove('active');
            });
            
            document.querySelectorAll('.nav-item').forEach(item => {
                item.classList.remove('active');
            });
            
            document.getElementById(topicId).classList.add('active');
            
            element.classList.add('active');
            
            if (window.innerWidth <= 1024) {
                 document.getElementById('mainContent').scrollIntoView({ behavior: 'smooth' });
            }
        }

        // --- Custom Message Box Functions ---
        const messageOverlay = document.getElementById('messageOverlay');
        const messageText = document.getElementById('messageText');

        function showMessage(message) {
            messageText.textContent = message;
            messageOverlay.classList.add('show');
        }

        function closeMessage() {
            messageOverlay.classList.remove('show');
        }
        // --- End Custom Message Box Functions ---
        
        function searchContent() {
            const searchTerm = document.getElementById('searchInput').value;
            
            if (!searchTerm || searchTerm.trim() === '') {
                showMessage('Please enter a search term.');
                return;
            }
            
            clearSearch(true); // Clear previous search but keep search term
            
            const content = document.getElementById('mainContent');
            const textNodes = getTextNodes(content);
            
            let found = false;
            let highlightCount = 0;
            
            textNodes.forEach(node => {
                const text = node.textContent;
                const lowerText = text.toLowerCase();
                const lowerSearchTerm = searchTerm.toLowerCase();

                if (lowerText.includes(lowerSearchTerm)) {
                    highlightText(node, searchTerm);
                    found = true;
                    // Count occurrences
                    highlightCount += (text.match(new RegExp(searchTerm, "gi")) || []).length;
                }
            });
            
            if (found) {
                const firstHighlight = document.querySelector('.highlight');
                if (firstHighlight) {
                    // Show the section containing the first highlight
                    let section = firstHighlight.closest('.topic-section');
                    if (section) {
                        document.querySelectorAll('.topic-section').forEach(s => s.classList.remove('active'));
                        section.classList.add('active');
                        
                        // Update nav
                        const sectionId = section.id;
                        document.querySelectorAll('.nav-item').forEach(item => {
                            item.classList.remove('active');
                            if (item.getAttribute('onclick').includes(`'${sectionId}'`)) {
                                item.classList.add('active');
                            }
                        });
                    }
                    
                    firstHighlight.scrollIntoView({ behavior: 'smooth', block: 'center' });
                }
                
                showMessage(`Found ${highlightCount} matches for "${searchTerm}"`);
            } else {
                showMessage('No results found for: ' + searchTerm);
            }
        }
        
        function getTextNodes(element) {
            const textNodes = [];
            const walker = document.createTreeWalker(
                element,
                NodeFilter.SHOW_TEXT,
                {
                    acceptNode: function(node) {
                        if (node.parentNode.tagName === 'SCRIPT' || 
                            node.parentNode.tagName === 'STYLE') {
                            return NodeFilter.FILTER_REJECT;
                        }
                        if (node.textContent.trim().length > 0) {
                            return NodeFilter.FILTER_ACCEPT;
                        }
                        return NodeFilter.FILTER_REJECT;
                    }
                }
            );
            
            let node;
            while (node = walker.nextNode()) {
                textNodes.push(node);
            }
            return textNodes;
        }
        
        function highlightText(node, searchTerm) {
            const text = node.textContent;
            const regex = new RegExp(`(${searchTerm.replace(/[-\/\\^$*+?.()|[\]{}]/g, '\\$&')})`, 'gi');
            
            if (regex.test(text)) {
                const resultFragment = document.createDocumentFragment();
                text.split(regex).forEach((part, index) => {
                    if (index % 2 === 1) { // It's a match
                        const span = document.createElement('span');
                        span.className = 'highlight';
                        span.textContent = part;
                        resultFragment.appendChild(span);
                    } else {
                        resultFragment.appendChild(document.createTextNode(part));
                    }
                });
                node.parentNode.replaceChild(resultFragment, node);
            }
        }
        
        function clearSearch(keepSearchTerm = false) {
            document.querySelectorAll('span.highlight').forEach(highlight => {
                const parent = highlight.parentNode;
                parent.replaceChild(document.createTextNode(highlight.textContent), highlight);
                parent.normalize();
            });
            
            if (!keepSearchTerm) {
                document.getElementById('searchInput').value = '';
            }
            
            // Show first core topic
            document.querySelectorAll('.topic-section').forEach((section, index) => {
                section.classList.toggle('active', index === 0);
            });
            
            document.querySelectorAll('.nav-item').forEach((item, index) => {
                 item.classList.toggle('active', index === 0);
            });
        }
        
        document.getElementById('searchInput').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                searchContent();
            }
        });
    </script>
</body>
</html>

